<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>Reaserch on North Korean OS - Red Star OS [eng/ru] [Not finished]</title>

  <link rel="stylesheet" href="/css/main.css">
  <!-- <link href="assets/favicon.ico" rel="icon" type="image/x-icon" /> -->
  <link rel="shortcut icon" type="image/png" href="assets//favicon.png">
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Reaserch on North Korean OS - Red Star OS [eng/ru] [Not finished] | Windows Internals Blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Reaserch on North Korean OS - Red Star OS [eng/ru] [Not finished]" />
<meta name="author" content="truebad0ur" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Some links at first as always: Sooo useful repo with tools You can download Red Star 2 here And Red Star 3 here And read some staff how intranet works in North Korea Files from this article will be uploaded to my TG channel Funny review video about Red Star OS Well, some time ago I made a forensics task for one of the CTF’s that we had in our university. And in that task I used Red Star OS, but didn’t mention the depth of it for researching. I mean they have their own browser, their own root “bypass” tool and much much more So now, as I don’t have a full-time job, I do have time for such a geek staff :) Some entering info: There are 4 versions of Red Star OS(RS further in the text): Version 1.0/Beta - 2008 [leaked] Version 2.0 - 2009 [leaked] Version 3.0 - 2012 [leaked] Version 4.0 - 2019 [unleaked] So our research will be focused on the third version Some tips and hacks will be taken from rutracker, that I linked above For me I was able to install it just with VMWare (hacks from rutracker for virtualbox didn’t work for me) rootsetting First thing to do after the installation is, obviously, get the root :) And good-natured korean programmers left a tool for us. It’s rootsetting - 753bd4ccdc4dddc8efe8f0eb4a46e837a6e1de0a I didn’t find any info in the internet about it, it’s hash on VirusTotal was also absent. But we can find a lot of interesting strings about who has developed it: (c) 2002,2003 KCC OIC rootsetting mirae@osd.inf.kp Maintainer - Kim Gyong Hun application for the root settings Application is being started at account of kcontroltray It’s a pretty simple program made with Qt and QWidget. It doesn’t have SUID bit, it’s owned by root, so it just changes root password in shadow file Didn’t reverse it a lot, but looks like it wasn’t necessary: admin_writeShadowFile We can also predict, that this soft was really written by Kim Gyong Hun, because what does this line really mean You cannot the root disable! :)))) Language Well, next we’d like to change interface language, easy: sudo sed -i &#39;s/ko_KP/en_US/g&#39; /etc/sysconfig/i18n sudo sed -i &#39;s/ko_KP/en_US/g&#39; /usr/share/config/kdeglobals Whoo! Now, let’s look around Browser! Browser Naenara, when it starts, is trying to connect to 10.76.1.11 From ome of the hackadays we have: Upon start-up, the browser tries to load a page located at IP address 10.76.1.11, which is a reserved IP address for private use. This indicated that North Korea’s “Internet” is actually more of in intranet. [Robert] suspects that the entire country may be running in private address space, similar to how your home or business likely runs. All the certs, that I extracted will also be in the channel, but nothing special there, as an example: Issued To: CN: GovRSA01 O : GovCA Issued By: CN: RootRSA01 O : RootCA Issued On 2010 09 29 Expired On 2015 09 28 Wandering a bit through browser files we have: naenara - 6f14260ee9fb054ccd4036f2efdfd1ef4746b180 It’s a binary file, but looks like it just execv’s /Applications/Naenara.app/Contents/RedStar/nnrbrowser nnrbrowser - f7877b7c7e04523fd656477c507a8679accdc693 SH script to run firefox from 00’s iptables: They also have snort preinstalled :) Rules for iptables look like this: # Generated by iptables-save v1.4.7 on Fri Apr 13 08:55:11 2012 *filter :INPUT DROP [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] :APPLICATION_FILTER - [0:0] :INTRUSION_PREVENTION_FILTER - [0:0] :USER_DEFINED_FILTER - [0:0] -A INPUT -i lo -j ACCEPT -A INPUT -j INTRUSION_PREVENTION_FILTER -A INPUT -j APPLICATION_FILTER -A INPUT -j USER_DEFINED_FILTER -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5353 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5353 --dport 1:65535 -j ACCEPT COMMIT # Completed on Fri Apr 13 08:55:11 2012" />
<meta property="og:description" content="Some links at first as always: Sooo useful repo with tools You can download Red Star 2 here And Red Star 3 here And read some staff how intranet works in North Korea Files from this article will be uploaded to my TG channel Funny review video about Red Star OS Well, some time ago I made a forensics task for one of the CTF’s that we had in our university. And in that task I used Red Star OS, but didn’t mention the depth of it for researching. I mean they have their own browser, their own root “bypass” tool and much much more So now, as I don’t have a full-time job, I do have time for such a geek staff :) Some entering info: There are 4 versions of Red Star OS(RS further in the text): Version 1.0/Beta - 2008 [leaked] Version 2.0 - 2009 [leaked] Version 3.0 - 2012 [leaked] Version 4.0 - 2019 [unleaked] So our research will be focused on the third version Some tips and hacks will be taken from rutracker, that I linked above For me I was able to install it just with VMWare (hacks from rutracker for virtualbox didn’t work for me) rootsetting First thing to do after the installation is, obviously, get the root :) And good-natured korean programmers left a tool for us. It’s rootsetting - 753bd4ccdc4dddc8efe8f0eb4a46e837a6e1de0a I didn’t find any info in the internet about it, it’s hash on VirusTotal was also absent. But we can find a lot of interesting strings about who has developed it: (c) 2002,2003 KCC OIC rootsetting mirae@osd.inf.kp Maintainer - Kim Gyong Hun application for the root settings Application is being started at account of kcontroltray It’s a pretty simple program made with Qt and QWidget. It doesn’t have SUID bit, it’s owned by root, so it just changes root password in shadow file Didn’t reverse it a lot, but looks like it wasn’t necessary: admin_writeShadowFile We can also predict, that this soft was really written by Kim Gyong Hun, because what does this line really mean You cannot the root disable! :)))) Language Well, next we’d like to change interface language, easy: sudo sed -i &#39;s/ko_KP/en_US/g&#39; /etc/sysconfig/i18n sudo sed -i &#39;s/ko_KP/en_US/g&#39; /usr/share/config/kdeglobals Whoo! Now, let’s look around Browser! Browser Naenara, when it starts, is trying to connect to 10.76.1.11 From ome of the hackadays we have: Upon start-up, the browser tries to load a page located at IP address 10.76.1.11, which is a reserved IP address for private use. This indicated that North Korea’s “Internet” is actually more of in intranet. [Robert] suspects that the entire country may be running in private address space, similar to how your home or business likely runs. All the certs, that I extracted will also be in the channel, but nothing special there, as an example: Issued To: CN: GovRSA01 O : GovCA Issued By: CN: RootRSA01 O : RootCA Issued On 2010 09 29 Expired On 2015 09 28 Wandering a bit through browser files we have: naenara - 6f14260ee9fb054ccd4036f2efdfd1ef4746b180 It’s a binary file, but looks like it just execv’s /Applications/Naenara.app/Contents/RedStar/nnrbrowser nnrbrowser - f7877b7c7e04523fd656477c507a8679accdc693 SH script to run firefox from 00’s iptables: They also have snort preinstalled :) Rules for iptables look like this: # Generated by iptables-save v1.4.7 on Fri Apr 13 08:55:11 2012 *filter :INPUT DROP [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] :APPLICATION_FILTER - [0:0] :INTRUSION_PREVENTION_FILTER - [0:0] :USER_DEFINED_FILTER - [0:0] -A INPUT -i lo -j ACCEPT -A INPUT -j INTRUSION_PREVENTION_FILTER -A INPUT -j APPLICATION_FILTER -A INPUT -j USER_DEFINED_FILTER -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5353 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5353 --dport 1:65535 -j ACCEPT COMMIT # Completed on Fri Apr 13 08:55:11 2012" />
<meta property="og:site_name" content="Windows Internals Blog" />
<meta property="og:image" content="/assets/previews/25.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/previews/25.jpg" />
<meta property="twitter:title" content="Reaserch on North Korean OS - Red Star OS [eng/ru] [Not finished]" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"truebad0ur"},"dateModified":"2023-11-23T00:00:00+00:00","datePublished":"2023-11-23T00:00:00+00:00","description":"Some links at first as always: Sooo useful repo with tools You can download Red Star 2 here And Red Star 3 here And read some staff how intranet works in North Korea Files from this article will be uploaded to my TG channel Funny review video about Red Star OS Well, some time ago I made a forensics task for one of the CTF’s that we had in our university. And in that task I used Red Star OS, but didn’t mention the depth of it for researching. I mean they have their own browser, their own root “bypass” tool and much much more So now, as I don’t have a full-time job, I do have time for such a geek staff :) Some entering info: There are 4 versions of Red Star OS(RS further in the text): Version 1.0/Beta - 2008 [leaked] Version 2.0 - 2009 [leaked] Version 3.0 - 2012 [leaked] Version 4.0 - 2019 [unleaked] So our research will be focused on the third version Some tips and hacks will be taken from rutracker, that I linked above For me I was able to install it just with VMWare (hacks from rutracker for virtualbox didn’t work for me) rootsetting First thing to do after the installation is, obviously, get the root :) And good-natured korean programmers left a tool for us. It’s rootsetting - 753bd4ccdc4dddc8efe8f0eb4a46e837a6e1de0a I didn’t find any info in the internet about it, it’s hash on VirusTotal was also absent. But we can find a lot of interesting strings about who has developed it: (c) 2002,2003 KCC OIC rootsetting mirae@osd.inf.kp Maintainer - Kim Gyong Hun application for the root settings Application is being started at account of kcontroltray It’s a pretty simple program made with Qt and QWidget. It doesn’t have SUID bit, it’s owned by root, so it just changes root password in shadow file Didn’t reverse it a lot, but looks like it wasn’t necessary: admin_writeShadowFile We can also predict, that this soft was really written by Kim Gyong Hun, because what does this line really mean You cannot the root disable! :)))) Language Well, next we’d like to change interface language, easy: sudo sed -i &#39;s/ko_KP/en_US/g&#39; /etc/sysconfig/i18n sudo sed -i &#39;s/ko_KP/en_US/g&#39; /usr/share/config/kdeglobals Whoo! Now, let’s look around Browser! Browser Naenara, when it starts, is trying to connect to 10.76.1.11 From ome of the hackadays we have: Upon start-up, the browser tries to load a page located at IP address 10.76.1.11, which is a reserved IP address for private use. This indicated that North Korea’s “Internet” is actually more of in intranet. [Robert] suspects that the entire country may be running in private address space, similar to how your home or business likely runs. All the certs, that I extracted will also be in the channel, but nothing special there, as an example: Issued To: CN: GovRSA01 O : GovCA Issued By: CN: RootRSA01 O : RootCA Issued On 2010 09 29 Expired On 2015 09 28 Wandering a bit through browser files we have: naenara - 6f14260ee9fb054ccd4036f2efdfd1ef4746b180 It’s a binary file, but looks like it just execv’s /Applications/Naenara.app/Contents/RedStar/nnrbrowser nnrbrowser - f7877b7c7e04523fd656477c507a8679accdc693 SH script to run firefox from 00’s iptables: They also have snort preinstalled :) Rules for iptables look like this: # Generated by iptables-save v1.4.7 on Fri Apr 13 08:55:11 2012 *filter :INPUT DROP [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] :APPLICATION_FILTER - [0:0] :INTRUSION_PREVENTION_FILTER - [0:0] :USER_DEFINED_FILTER - [0:0] -A INPUT -i lo -j ACCEPT -A INPUT -j INTRUSION_PREVENTION_FILTER -A INPUT -j APPLICATION_FILTER -A INPUT -j USER_DEFINED_FILTER -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 22 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 80 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 443 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5900 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 631 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 135 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 137 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 137 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 138 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 139 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 445 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 445 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 20 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 21 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 548 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5353 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 22 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 80 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 443 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5900 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 631 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 135 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 138 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 139 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 20 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 21 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 548 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p tcp -m tcp --sport 5353 --dport 1:65535 -j ACCEPT -A APPLICATION_FILTER -p udp -m udp --sport 5353 --dport 1:65535 -j ACCEPT COMMIT # Completed on Fri Apr 13 08:55:11 2012","headline":"Reaserch on North Korean OS - Red Star OS [eng/ru] [Not finished]","image":"/assets/previews/25.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"/2023/11/23/Research-Red-Star-OS.html"},"url":"/2023/11/23/Research-Red-Star-OS.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<link href="assets/favicon.ico" rel="icon" type="image/x-icon" />

<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/">
    <link rel="shortcut icon" href="/assets/favicon.ico">
    
    <h1>truebad0ur@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/archive.html"><h2 class="header-link">Archive</h2></a>
<a href="/about.html"><h2 class="header-link">About</h2></a>
<a href="/ToDo.html"><h2 class="header-link">ToDo</h2></a>
<a href="/Certificates.html"><h2 class="header-link">Certificates</h2></a>
<!--<a href="https://t.me/reverse_dungeon"><h2 class="header-link">Telegram</h2></a>-->

    </div>
  </div>
</header>

    <div class="container">
      <section id="main_content">
        <article>
  <p>Some links at first as always:</p>

<ul>
  <li><a href="https://github.com/takeshixx/redstar-tools">Sooo useful repo with tools</a></li>
  <li><a href="https://rutracker.org/forum/viewtopic.php?t=5830445">You can download Red Star 2 here</a></li>
  <li><a href="https://rutracker.org/forum/viewtopic.php?t=5830480">And Red Star 3 here</a></li>
  <li><a href="https://www.forensicxs.com/north-korea-and-the-web/">And read some staff how intranet works in North Korea</a></li>
  <li><a href="https://t.me/reverse_dungeon">Files from this article will be uploaded to my TG channel</a></li>
  <li><a href="https://www.youtube.com/watch?v=zPeYODmEoTM">Funny review video about Red Star OS</a></li>
</ul>

<p>Well, some time ago I made a forensics task for one of the CTF’s that we had in our university. And in that task I used Red Star OS, but didn’t mention the depth of it for researching. I mean they have their own browser, their own root “bypass” tool and much much more</p>

<p>So now, as I don’t have a full-time job, I do have time for such a geek staff :)</p>

<p>Some entering info:</p>

<p>There are 4 versions of Red Star OS(RS further in the text):</p>

<ol>
  <li>Version 1.0/Beta - 2008 [leaked]</li>
  <li>Version 2.0 - 2009 [leaked]</li>
  <li>Version 3.0 - 2012 [leaked]</li>
  <li>Version 4.0 - 2019 [unleaked]</li>
</ol>

<p>So our research will be focused on the third version</p>

<p>Some tips and hacks will be taken from rutracker, that I linked above</p>

<p>For me I was able to install it just with VMWare (hacks from rutracker for virtualbox didn’t work for me)</p>

<h3 id="rootsetting"><a href="#header-3"></a>rootsetting</h3>

<p>First thing to do after the installation is, obviously, get the root :)</p>

<p>And good-natured korean programmers left a tool for us. It’s <code class="language-plaintext highlighter-rouge">rootsetting - 753bd4ccdc4dddc8efe8f0eb4a46e837a6e1de0a</code></p>

<p>I didn’t find any info in the internet about it, it’s hash on VirusTotal was also absent. But we can find a lot of interesting strings about who has developed it:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="mi">2002</span><span class="p">,</span><span class="mi">2003</span> <span class="nx">KCC</span> <span class="nx">OIC</span>
<span class="nx">rootsetting</span>
<span class="nx">mirae</span><span class="p">@</span><span class="nd">osd</span><span class="p">.</span><span class="nx">inf</span><span class="p">.</span><span class="nx">kp</span>
<span class="nx">Maintainer</span> <span class="o">-</span> <span class="nx">Kim</span> <span class="nx">Gyong</span> <span class="nx">Hun</span>
<span class="nx">application</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">root</span> <span class="nx">settings</span>
<span class="nx">Application</span> <span class="nx">is</span> <span class="nx">being</span> <span class="nx">started</span> <span class="nx">at</span> <span class="nx">account</span> <span class="k">of</span> <span class="nx">kcontroltray</span>
</code></pre></div></div>

<p>It’s a pretty simple program made with Qt and QWidget. It doesn’t have SUID bit, it’s owned by root, so it just changes root password in shadow file</p>

<p>Didn’t reverse it a lot, but looks like it wasn’t necessary: <code class="language-plaintext highlighter-rouge">admin_writeShadowFile</code></p>

<p>We can also predict, that this soft was really written by Kim Gyong Hun, because what does this line really mean <code class="language-plaintext highlighter-rouge">You cannot the root disable!</code> :))))</p>

<h3 id="language"><a href="#header-3"></a>Language</h3>

<p>Well, next we’d like to change interface language, easy:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo sed -i 's/ko_KP/en_US/g' /etc/sysconfig/i18n
sudo sed -i 's/ko_KP/en_US/g' /usr/share/config/kdeglobals
</code></pre></div></div>

<p>Whoo!</p>

<p>Now, let’s look around</p>

<p><img src="/assets/redstaros1.png" alt="redstaros1" /></p>

<p>Browser!</p>

<h3 id="browser"><a href="#header-3"></a>Browser</h3>

<p>Naenara, when it starts, is trying to connect to 10.76.1.11</p>

<p>From ome of the <a href="https://hackaday.com/2015/01/10/messing-around-with-naenara-north-koreas-web-browser/">hackadays</a> we have:</p>

<p><code class="language-plaintext highlighter-rouge">Upon start-up, the browser tries to load a page located at IP address 10.76.1.11, which is a reserved IP address for private use. This indicated that North Korea’s “Internet” is actually more of in intranet. [Robert] suspects that the entire country may be running in private address space, similar to how your home or business likely runs.</code></p>

<p>All the certs, that I extracted will also be in the channel, but nothing special there, as an example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Issued To:
CN: GovRSA01
O : GovCA

Issued By:
CN: RootRSA01
O : RootCA

Issued On 2010 09 29
Expired On 2015 09 28
</code></pre></div></div>

<p>Wandering a bit through browser files we have:</p>

<p><code class="language-plaintext highlighter-rouge">naenara - 6f14260ee9fb054ccd4036f2efdfd1ef4746b180</code></p>

<p>It’s a binary file, but looks like it just execv’s /Applications/Naenara.app/Contents/RedStar/nnrbrowser</p>

<p><code class="language-plaintext highlighter-rouge">nnrbrowser - f7877b7c7e04523fd656477c507a8679accdc693</code></p>

<p><a href="https://www.linuxquestions.org/questions/linux-software-2/distribute-firefox-files-162858/">SH script to run firefox from 00’s</a></p>

<h3 id="iptables"><a href="#header-3"></a>iptables:</h3>

<p>They also have snort preinstalled :)</p>

<p>Rules for iptables look like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Generated by iptables-save v1.4.7 on Fri Apr 13 08:55:11 2012
*filter
:INPUT DROP [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:APPLICATION_FILTER - [0:0]
:INTRUSION_PREVENTION_FILTER - [0:0]
:USER_DEFINED_FILTER - [0:0]
-A INPUT -i lo -j ACCEPT 
-A INPUT -j INTRUSION_PREVENTION_FILTER 
-A INPUT -j APPLICATION_FILTER 
-A INPUT -j USER_DEFINED_FILTER 
-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 22 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 22 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 80 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 80 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 443 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 443 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5900 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5900 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 631 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 631 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 135 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 135 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 137 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 137 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 137 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 137 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 138 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 138 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 139 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 139 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 445 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 445 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 445 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 445 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 20 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 20 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 21 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 21 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 548 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 548 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 1:65535 --dport 5353 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 1:65535 --dport 5353 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 22 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 22 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 80 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 80 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 443 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 443 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 5900 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 5900 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 631 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 631 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 135 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 135 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 138 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 138 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 139 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 139 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 20 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 20 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 21 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 21 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 548 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 548 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p tcp -m tcp --sport 5353 --dport 1:65535 -j ACCEPT 
-A APPLICATION_FILTER -p udp -m udp --sport 5353 --dport 1:65535 -j ACCEPT 


COMMIT
# Completed on Fri Apr 13 08:55:11 2012
</code></pre></div></div>

</article>
      </section>
    </div>
  </div>
</body>

</html>
